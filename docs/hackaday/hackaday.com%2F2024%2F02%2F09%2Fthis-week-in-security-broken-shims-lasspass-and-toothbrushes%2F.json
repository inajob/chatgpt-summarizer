{"pubDate": "2024-02-09T15:00:03", "original_title": "This Week in Security: Broken Shims, LassPass, and Toothbrushes?", "link": "https://hackaday.com/2024/02/09/this-week-in-security-broken-shims-lasspass-and-toothbrushes/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2016/01/darkarts.jpg", "original_content": "Linux has a shim problem. Which naturally leads to a reasonable question: Whats a shim, and why do we need it? The answer: Making Linux work wit Secure Boot, and an unintended quirk of the GPLv3.\nSecure Boot is the verification scheme in modern machines that guarantees that only a trusted OS can boot. When Secure Boot was first introduced, many Linux fans suggested it was little more than an attempt to keep Linux distros off of consumers machines. That fear seems to have been unwarranted, as Microsoft has dutifully kept the Linux Shim signed, so we can all run Linux distros on our Secure Boot machines.\nSo the shim. Its essentially a first-stage bootloader, that can boot a signed GRUB2 or other target. You might ask, why cant we just ask Microsoft to sign GRUB2 directly? And thats where the GPLv3 comes in. That license has an anti-tivoization section, which specifies Installation Information as part of what must be provided as part of GPLv3 compliance. And Microsofts legal team understands that requirement to apply to even this signing process. And it would totally defeat the point of Secure Boot to release the keys, so no GPLv3 code gets signed. Instead, we get the shim.\nNow that we understand the shim, lets cover how its broken. The most serious vulnerability is a buffer overflow in the HTTP file transfer code. The buffer is allocated based on the size in the HTTP header, but a malicious HTTP server can set that value incorrectly, and the shim code would happily write the real HTTP contents past the end of that buffer, leading to arbitrary code execution. You might ask, why in the world does the shim have HTTP code in it at all? The simple answer is to support UEFI HTTP Boot, a replacement for PXE boot.\nThe good news is that this vulnerability can only be triggered when using HTTP boot, and only by connecting to a malicious server or via a man-in-the-middle attack. With this in mind, its odd that this vulnerability is rated a 9.8. Specifically, it seems incorrect that this bug is rated low complexity, or a general network attack vector. In Red Hats own write-up of the vulnerability, they argue that the exploitation is high complexity, and is only possible from an adjacent network. There were a handful of lesser vulnerabilities found, and these were all fixed with shim 15.8.\nLassPass Banned from the App Store\nAll we lack here is another app name LastPast, and wed have the App Store equivalent of three different Spidermen standing in a circle pointing at each other. The devs behind the LastPass app found a suspiciously similar looking LassPass app on the Apple App Store. Weve seen typosquatting on a bunch of Open Source software repositories, but its a problem on the app stores, too.\nThree Million Toothbrushes\nA story took the security world by storm this week: Three million smart toothbrushes had been compromised, and were used to launch a Distributed Denial of Service (DDoS) attack on a Swiss website. The story originated on a Swiss news website, and was referencing an interview with Stefan Z\u00fcger of Fortinet.\nBefore we give away the rest of the story, lets think about this. The story would be a big deal, but this seems to be the only original source on the Internet. The toothbrush brand isnt named, and neither is the company that was DDoSd. Nor was a specific botnet or malware family listed. Smart toothbrushes do exist, but theyre not going to be exposed to the Internet en masse. In fact, it would be unusual for one of these to have connectivity beyond simple Bluetooth. How would malware even get to one of these devices to compromise it?\nWe could construct a scenario where this could happen. A smart toothbrush would have to have Wifi connection as part of its setup process. This sounds weird, but Ive seen sillier IoT behavior. Then, the only way to explain so many devices getting compromised all at once is a malicious firmware update. Either through a supply chain attack, or something silly like a domain name lapsing and getting claimed by a threat actor. This rather convoluted scenario could actually explain a three million toothbrush botnet.\nBut if you havent caught on yet, this didnt happen. Its a hypothetical scenario roughly based on earlier Fortinet research into what could be done with toothbrush malware (PDF). Bleeping Computer has gotten an official response from Fortinet:\nTo clarify, the topic of toothbrushes being used for DDoS attacks was presented during an interview as an illustration of a given type of attack, and it is not based on research from Fortinet or FortiGuard Labs. It appears that due to translations the narrative on this topic has been stretched to the point where hypothetical and actual scenarios are blurred.\nThats not quite the end of the story. The site, Aargauer Zeitung was pretty explicit that Stefan from Fortinet said this attack was real in the original article. In response to Fortinets announcement, theyve amended that article, but also published a response, claiming that there was no translation issue  they all speak German after all. They report that Fortinet listed the toothbrush attack as real, gave details about how long it lasted, and about how expensive it was for the victim. The most surprising detail here is that Fortinet did a pre-publication review of the piece, and signed off on it.\n\nSo whats the takeaway here? For one, news sites sometimes get it wrong. If a story seems weird, look for the primary sources. If there arent any primary sources, then just maybe something isnt quite as reported. Its not entirely clear where the communication breakdown happened in this case, but what seems most likely is that a Fortinet employee read an internal case-study on a hypothetical attack, and thought it was describing a real event. Of all the coverage of this, I think I like the Malwarebytes Blog story the best.\nBits and Bytes\nTheres an interesting trick that security researchers have played on themselves. There are too many honeypots out there. Or maybe the problem is that the honeypots are too good at acting like real hardware. Regardless, the process of tracking the number of accessible, vulnerable devices on the Internet is getting to be pretty challenging. The example given is the presence of over 200,000 Confluence results on Shodan, but only 5,000 actual favicon results. That suggests theres 40 Confluence honeypots for each real server. The mind boggles.\nApparently some heat pumps from Alpha Innotec and Novelan have an undocumented feature: SSH access with a known root password. Thats one way to keep Home Assistant users from spamming your API servers. It probably wasnt intentional, though. It just happens that a simple password hashed with 3DES can be broken in seconds on a modern machine. Its eschi if you wondered.\nAnd finally, there was a vulnerability in Mastodon published last week. This is a bug in the federated account handling, such that an attacker can impersonate an account from another server. The update is out now, but the full details wont be public until the 15th to give server operators time to update. Hackaday.social is already updated, if you wondered.", "title": "Linux\u306e\u30b7\u30e0\u306b\u95a2\u3059\u308b\u554f\u984c\u3068\u306f\u4f55\u304b", "body": "Linux\u306e\u300cshim\u300d\u306b\u306f\u554f\u984c\u304c\u3042\u308a\u3001\u30bb\u30ad\u30e5\u30a2\u30d6\u30fc\u30c8\u3068\u306e\u4e92\u63db\u6027\u3092\u78ba\u4fdd\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u8106\u5f31\u6027\u3082\u3042\u308a\u307e\u3059\u304c\u3001Secure Boot\u306b\u3088\u308b\u5236\u9650\u3068\u306e\u30d0\u30e9\u30f3\u30b9\u304c\u53d6\u3089\u308c\u3066\u3044\u308b\u3068\u8a00\u3048\u307e\u3059\u3002\u307e\u305f\u3001\u30d5\u30a7\u30c7\u30ec\u30fc\u30b7\u30e7\u30f3\u30a2\u30ab\u30a6\u30f3\u30c8\u53d6\u308a\u6271\u3044\u306e\u8106\u5f31\u6027\u3082\u5831\u544a\u3055\u308c\u305f\u305f\u3081\u3001\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u304c\u5fc5\u8981\u3067\u3059\u3002", "titles": ["Linux\u306e\u30b7\u30e0\u306b\u95a2\u3059\u308b\u554f\u984c\u3068\u306f\u4f55\u304b", "\u30bb\u30ad\u30e5\u30a2\u30d6\u30fc\u30c8\u306b\u5fc5\u8981\u306a\u7406\u7531\u3068\u306f", "300\u4e07\u672c\u306e\u30b9\u30de\u30fc\u30c8\u306a\u6b6f\u30d6\u30e9\u30b7\u304c\u30cf\u30c3\u30ad\u30f3\u30b0\u3055\u308c\u305f\u8a71", "\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u7814\u7a76\u8005\u304c\u76f4\u9762\u3059\u308b\u554f\u984c\uff1a\u904e\u5270\u306a\u30cf\u30cb\u30fc\u30dd\u30c3\u30c8", "Mastodon\u306e\u8106\u5f31\u6027\u516c\u958b\uff1a\u30b5\u30fc\u30d0\u30fc\u30aa\u30da\u30ec\u30fc\u30bf\u30fc\u306b\u6642\u9593\u3092\u4e0e\u3048\u308b\u305f\u3081\u306b\u8a73\u7d30\u304c\u516c\u958b\u3055\u308c\u308b\u4e88\u5b9a"]}