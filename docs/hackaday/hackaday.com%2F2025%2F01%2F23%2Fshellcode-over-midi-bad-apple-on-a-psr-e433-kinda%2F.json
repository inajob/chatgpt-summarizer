{"pubDate": "2025-01-23T15:00:00", "original_title": "Shellcode over MIDI? Bad Apple on a PSR-E433, Kinda", "link": "https://hackaday.com/2025/01/23/shellcode-over-midi-bad-apple-on-a-psr-e433-kinda/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2025/01/yamaha-psr-e433-bad-apple-demo-u6sukvmijbg-webm-shot0008_featured.png", "original_content": "If hacking on consumer hardware is about figuring out what it can do, and pushing it in directions that the manufacturer never dared to dream, then this is a very fine hack indeed. [Portasynthica3] takes on the Yamaha PSR-E433, a cheap beginner keyboard, discovers a shell baked into it, and takes it from there.\n[Portasynthinca3] reverse engineered the firmware, wrote shellcode for the device, embedded the escape in a MIDI note stream, and even ended up writing some simple LCD driver software totally decent refresh rate on the dot-matrix display, all to support the lofty goal of displaying arbitrary graphics on the keyboard\u2019s dot-matrix character display.\nNow, we want you to be prepared for a low-res video extravaganza here. You might have to squint a bit to make out whats going on in the video, but keep in mind that it\u2019s being sent over a music data protocol from the 1980s, running at 31.25 kbps, displayed in the custom character RAM of an LCD.\nAs always, the hack starts with research. Identifying the microcontroller CPU lead to JTAG and OpenOCD. (We love the technique of looking at the draw on a bench power meter to determine if the chip is responding to pause commands.) Dumping the code and tossing it into Ghidra lead to the unexpected discovery that Yamaha had put a live shell in the device that communicates over MIDI, presumably for testing and development purposes. This shell had PEEK and POKE, which meant that OpenOCD could go sit back on the shelf. Poking \u201cHello World\u201d into some free RAM space over MIDI sysex was the first proof-of-concept.\nThe final hack to get video up and running was to dig deep into the custom character-generation RAM, write some code to disable the normal character display, and then fool the CPU into calling this code instead of the shell, in order to increase the update rate. All of this for a thin slice of Bad Apple over MIDI, but more importantly, for the glory. And this hack is glorious! Go check it out in full.\nMIDI is entirely hacker friendly, and it\u2019s likely you can hack together a musical controller that would wow your audience just with stuff in your junk box. If you\u2019re at all into music, and you\u2019ve never built your own MIDI devices, you have your weekend project.\n\n\nThanks [James] for the gonzo tip!", "title": "- \u30e4\u30de\u30cfPSR-E433\u3092\u30cf\u30c3\u30af\u3057\u3001\u65b0\u305f\u306a\u6a5f\u80fd\u3092\u5f15\u304d\u51fa\u3059\u9b45\u529b\u7684\u306a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8", "body": "Yamaha\u306e\u30ad\u30fc\u30dc\u30fc\u30c9PSR-E433\u3092\u6539\u9020\u3057\u3001MIDI\u7d4c\u7531\u3067\u52d5\u753b\u8868\u793a\u3092\u5b9f\u73fe\u3057\u305f\u30cf\u30c3\u30af\u306e\u8a71\u3002", "titles": ["- \u30e4\u30de\u30cfPSR-E433\u3092\u30cf\u30c3\u30af\u3057\u3001\u65b0\u305f\u306a\u6a5f\u80fd\u3092\u5f15\u304d\u51fa\u3059\u9b45\u529b\u7684\u306a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8", "- MIDI\u3092\u7528\u3044\u305f\u30ec\u30c8\u30ed\u306a\u6620\u50cf\u8868\u793a\u306e\u5b9f\u73fe", "- \u9006\u30a2\u30bb\u30f3\u30d6\u30eb\u304b\u3089\u59cb\u307e\u308b\u96fb\u5b50\u697d\u5668\u306e\u6539\u9020", "- MIDI\u30c7\u30fc\u30bf\u3067\u9001\u4fe1\u3055\u308c\u308b\u6620\u50cf\u4f53\u9a13\uff1a\u4f4e\u89e3\u50cf\u5ea6\u306e\u6311\u6226", "- \u81ea\u4f5cMIDI\u30c7\u30d0\u30a4\u30b9\u306e\u88fd\u4f5c\u30a2\u30a4\u30c7\u30a2\u3068\u305d\u306e\u9b45\u529b"]}