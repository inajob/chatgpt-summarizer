{"pubDate": "2023-12-01T15:00:09", "original_title": "This Week in Security: Owncloud, NXP, 0-Days, and Fingerprints", "link": "https://hackaday.com/2023/12/01/this-week-in-security-owncloud-nxp-0-days-and-fingerprints/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2016/01/darkarts.jpg", "original_content": "Were back! And while the column took a week off for Thanksgiving, the security world didnt. The most pressing news is an issue in Owncloud, that is already under active exploitation.\nThe problem is a library that can be convinced to call phpinfo() and include the results in the page response. That function reveals a lot of information about the system Owncloud is running on, including environment variables. In something like a Docker deployment, those environment variables may contain system secrets like admin username and password among others.\nNow, there is a bit of a wrinkle here. There is a public exploit, and according to research done by Greynoise Labs, that exploit does not actually work against default installs. This seems to describe the active exploitation attempts, but the researcher that originally found the issue has stated that there is a non-public exploit that does work on default installs. Stay tuned for this other shoe to drop, and update your Owncloud installs if you have them.\n\nI'm talking about a real exploit, which is to my knowledge not public yet. The one you linked won't work.\n Charles Fol (@cfreal_) November 30, 2023\n\nNXP\nIf we consider a chip manufacturer, who makes chips that get included in loads of devices, whats the worst case security scenario? How about a skilled attacker in the corporate network for over two years before detection? Thats the reported situation at NXP from 2017 to 2020. The threat group Chimera managed to gain a foothold on an NXP employee workstation, and very methodically pushed deeper into the network.\nFirst, theres the obvious possibility that chip designs and source code was leaked for NXP products. An even more worrying scenario is that vulnerability reports were part of the data exfiltrated, possibly giving these attackers an early chance to use unpatched vulnerabilities. We could speculate about even more worrying possibilities, but at this point there is no evidence of any tampering or other supply chain attacks.\nChimera is almost certainly a professional Chinese Advanced Persistent Threat (APT), a bit of innuendo for a state-affiliated hacking group. This is hilariously evidenced by the clockwork precision in working hours, synced to Chinese office hours, lunch break included. There was even a telling break taken for Chinese Golden Week.\nToo Many Secrets\nSo this one is weird. There are a pair of 0-day attacks in the wild, one against a popular router, the other against a Network Video Recorder. From the scant details in the Akamai report, we can conclude that the attacks depend on default username and password. Both detection rules mention NTP hostname, so this is likely a command injection flaw in both devices. But what devices? Akamai has opted not to specify.\nThats an unfortunate decision, as these exploits are already in the wild. The advantage is already given to the attacker, and Akamai has opted not to let the rest of us know what devices to even be worried about. The likely reason is that this is a trivial exploit, and the detection rules give away enough for anyone to reverse engineer the attack. Its still a disappointing decision.\nFingerprints\nUp next is a masterclass on hardware hacking from Blackwing Intelligence. A security team at Microsoft tasked the Blackwing researchers with trying to crack the fingerprint sensors used in several laptops for the Windows Hello login feature. These fingerprint readers all work using a Match on Chip (MoC) approach, where the fingerprint sensor itself is secure (theoretically) and trusted to do the actual fingerprint verification. To keep that safe, Microsoft has designed the Secure Device Connection Protocol (SDCP) to provide a way to verify the trustworthiness of the device and data being transferred.\nThat protocol actually seems pretty robust, using a good encryption and authentication scheme. To really dig in, our heroes took the Linux fingerprint scanner driver for one of the laptops, and used it to construct a Wireshark Dissector. And thats when they discovered the first sign of trouble. The Linux authentication flow worked differently from that of Windows.\nThe real problem is that the fingerprint reader firmware accepts a less secure implementation of SDCP. To mitigate the danger this poses, the firmware expects to receive a configuration packet at the beginning of an authentication flow that specifies which driver is being used, with the firmware maintaining a separate database of users for each flow. That configuration packet just happens to be unauthenticated and in the clear. The hack that ended up working was to generate a spoofed user from Linux, reboot to Windows, and then inject a config packet telling the scanner to use its Linux driver database.\nThe device that had the simplest bypass just happened to be Microsofts own Surface Pro Type Cover. In a cringe-worthy oversight, this device doesnt use SDCP at all. All an attacker has to do is unplug the Type Cover and plug in a malicious USB device that spoofs the covers ID. My finger is my passport, verify me.\nBLUFFS\nAnd because we didnt have enough these past two weeks to keep us all on our toes, theres a new novel attack against Bluetooth, the BLUetooth Forward and Future Secrecy attack, BLUFFS. The key idea here is making a Bluetooth connection to a target device with an intentionally weak key, breaking the cryptography of that session, and then manipulating the target into reusing the broken cryptography material for future sessions. See the PDF write-up for all the juicy details.\nBits and Bytes\nA Cyberlink installer has been discovered containing malicious code. This installer is properly signed, and was hosted on Cyberlink infrastructure. The group behind this supply chain attack is believed to be Diamond Sleet, a North Korean APT. Microsoft has added this compromised certificate to its revocation list, and taken down the second-stage code from Github where it was being hosted.\nOwn a domain? Wonder if someone has ever tried to typosquat your domain? Theres now a service to check. Have I Been Squatted takes a given domain name and runs it through a few permuting tools, checking for registered domains based on typos, different TLDs, and even punycode tricks. See the announcement for more details.\nAnd finally, remember the trope from cartoons and cheesy sci-fi episodes, where the nearly omniscient AI is defeated by triggering a paradox or endless loop? Our new AI overlords are similarly vulnerable. It turns out if you simply ask ChatGPT to repeat a given word forever, it will try to do so. For a while. Eventually the AI model breaks, and it starts spitting out raw training data. Thats non-ideal. But at least we know how to escape the clutches of an evil AI if we ever find ourselves there.", "title": "\u96fb\u5b50\u5de5\u4f5c\u306b\u95a2\u3059\u308b\u30bf\u30a4\u30c8\u30eb\u306e\u63d0\u6848\uff1a", "body": "11/30\u73fe\u5728\u3001Owncloud\u306e\u554f\u984c\u3092\u62b1\u3048\u3066\u3044\u307e\u3059\u3002\u516c\u958b\u3055\u308c\u305f\u30a8\u30af\u30b9\u30d7\u30ed\u30a4\u30c8\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306b\u306f\u6a5f\u80fd\u3057\u306a\u3044\u304c\u3001\u975e\u516c\u958b\u306e\u30a8\u30af\u30b9\u30d7\u30ed\u30a4\u30c8\u306f\u6a5f\u80fd\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002NXP\u3067\u306f\u30012017\u5e74\u304b\u30892020\u5e74\u307e\u3067\u4f01\u696d\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u4fb5\u5165\u3055\u308c\u3066\u304a\u308a\u3001\u60c5\u5831\u306e\u6f0f\u6d29\u3084\u8106\u5f31\u6027\u3092\u4f7f\u3063\u305f\u653b\u6483\u306e\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\u3055\u3089\u306b\u3001\u30eb\u30fc\u30bf\u30fc\u3084Network Video Recorder\u306b\u306f\u65e2\u77e5\u306e\u8106\u5f31\u6027\u304c\u3042\u308a\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30e6\u30fc\u30b6\u30fc\u540d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u653b\u6483\u304c\u884c\u308f\u308c\u3066\u3044\u307e\u3059\u3002\u307e\u305f\u3001Windows Hello\u306e\u6307\u7d0b\u8a8d\u8a3c\u306b\u3082\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u306e\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002Bluetooth\u306b\u306fBLUFFS\u3068\u3044\u3046\u65b0\u305f\u306a\u653b\u6483\u624b\u6cd5\u304c\u3042\u308a\u307e\u3059\u3002", "titles": ["\u96fb\u5b50\u5de5\u4f5c\u306b\u95a2\u3059\u308b\u30bf\u30a4\u30c8\u30eb\u306e\u63d0\u6848\uff1a", "", "Owncloud\u306b\u95a2\u3059\u308b\u8106\u5f31\u6027\u304c\u60aa\u7528\u3055\u308c\u3066\u3044\u308b", "NXP\u304c2\u5e74\u4ee5\u4e0a\u306e\u653b\u6483\u306b\u3055\u3089\u3055\u308c\u308b", "\u4eba\u6c17\u30eb\u30fc\u30bf\u30fc\u3068\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30d3\u30c7\u30aa\u30ec\u30b3\u30fc\u30c0\u30fc\u306b0-day\u653b\u6483\u304c\u5b58\u5728", "Windows Hello\u306e\u6307\u7d0b\u30bb\u30f3\u30b5\u30fc\u306b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u554f\u984c\u304c\u3042\u308b", "Bluetooth\u306e\u65b0\u3057\u3044\u653b\u6483\u624b\u6cd5\u300cBLUFFS\u300d\u304c\u767b\u5834"]}