{"pubDate": "2024-04-26T14:00:47", "original_title": "This Week in Security: Cisco, Mitel, and AI False Flags", "link": "https://hackaday.com/2024/04/26/this-week-in-security-cisco-mitel-and-ai-false-flags/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2016/01/darkarts.jpg", "original_content": "Theres a trend recently, of big-name security appliances getting used in state-sponsored attacks. It looks like Cisco is the latest victim, based on a report by their own Talos Intelligence.\nThis particular attack has a couple of components, and abuses a couple of vulnerabilities, though the odd thing about this one is that the initial access is still unknown. The first part of the infection is Line Dancer, a memory-only element that disables the system log, leaks the system config, captures packets and more. A couple of the more devious steps are taken, like replacing the crash dump process with a reboot, to keep the in-memory malware secret. And finally, the resident installs a backdoor in the VPN service.\nThere is a second element, Line Runner, that uses a vulnerability to arbitrary code from disk on startup, and then installs itself onto the device. That one is a long term command and control element, and seems to only get installed on targeted devices. The Talos blog makes a rather vague mention of a 32-byte token that gets pattern-matched, to determine an extra infection step. It may be that Line Runner only gets permanently installed on certain units, or some other particularly fun action is taken.\nFixes for the vulnerabilities that allowed for persistence are available, but again, the initial vector is still unknown. Theres a vulnerability that just got fixed, that could have been such a vulnerability. CVE-2024-20295 allows an authenticated user with read-only privileges perform a command injection as root. Proof of Concept code is out in the wild for this one, but so far theres no evidence it was used in any attacks, including the one above.\nMitel Pop From the Front Panel\nThe good folks at Baldur decided to go hunting for bugs in Mitel VoIP phones. These are pretty commonly used in businesses and hotel back offices. And the first brilliant find was a system compromise just from punching buttons on the phone. Under diagnostics in the menu, the diagnostic server setting is used to upload logs and system information. That setting apparently gets passed into a shell command, as an ampersand is all it takes to execute commands. You can bet that the next time Im around a Mitel phone, Im trying reboot;. Thats technically protected by an admin password  which is usually set to 1234.\nBut wait, theres more. The front panel hack was useful for getting a toehold to run a debugger and other tools, but we need to go deeper. Theres a webserver on port 80, for doing device configuration. It has GET requests locked down reasonably well, but theres a really odd quirk, that POST requests dont have to be authorized, so long as a valid GET request has been made within the last 10 minutes. That would be something on its own, but even better is the fact that there are a few GET requests that trigger the timer, and dont require authentication. The winner here is the humble favicon.\nThe last step was finding a buffer overflow in a routine that sets the MAC address from within the web interface. The tricky thing here is that the overflow code first gets handled by a strcat and strcpy, meaning a NULL byte ends the exploit data. It took some doing, but the team found a gadget chain that got to shellcode while walking the tightrope. They celebrated with a bit of the Imperial march.\nFalse Flag Malware\nWhat happens when you have a database where a user can upload arbitrary data, and an over-zealous pattern-matching anti-malware engine is running? Database deletion wasnt on my bingo card, but here we are. Its a literal false flag: create a fake malicious signature, to trick the anti-malware into doing the malicious thing instead. Microsoft Defender and Kaspersky EDR are the two applications called out here, though its likely other anti-virus programs would be subject to similar tricks. Microsoft issued a CVE and has shipped a fix, and Kaspersky rolled out some mitigations as well.\nFalse Flag Slander\nAnd then there was this AI-enabled false flag. A school principal was caught on a hot mic, expressing some concerning and racially-charged opinions about students, community members, and other school staff. The audio was leaked, the student body got wind of it, and the principles scalp was metaphorically called for.\nBut it was the schools athletic director, with a speech-cloning service, and he has been arrested, which is sure to lead to an interesting court case. And sadly, this isnt an isolated incident, as hoaxes have become relatively common, and this isnt the first time an AI voice has been used maliciously. As much as we hate to say it, look for more of this to come.\nZombie Worm\nWhat happens with a self-propagating worm gets its head cut off? Apparently it turns into a zombie worm. A strain of PlugX malware gained the ability to hop a ride on USB drives a few years back, with all of those infected machines reporting to a single CC server. That server went offline, and researchers managed to snag the IP address. Thats important to prevent someone else raising the zombies back to unlife, but it also gives us a really interesting look into the infected machine stats.\nNigeria seems to hold the crown for the most infected machines, with India holding down second place. Some researchers have seen a Chinese theme in the data, suggesting China was patient zero, the origin of the worm, or maybe both. With researchers in control of the CC IP, there is the possibility of issuing remote uninstall commands, but there are both legal and logistical challenges to that idea.\nPSA: phpecc\nAnd heres a PSA for you PHP programmers. (We know youre out there!) The phpecc library appears to have been abandoned. Statistics suggest its still getting over a thousand downloads a day, which isnt great given that there are some outstanding CVEs in the codebase.\nThe codebase has been forked by Paragon Initiative Enterprises, P.I.E., who warn against fully trusting the code until an audit has completed. This is one to watch for a while, and be aware of the potential faults of the older versions.\nBits and Bytes\nPhylum is back, reporting more malicious packages in NPM. These seem to be coming from the same threat actors as have uploaded malware before, and thought to be North Korean actors. Its fairly straightforward, with a preinstall hook running obfuscated JS code. This one is interesting, as it seems to be going after MacOS systems. Theres also an interesting bashism that has sneaked into the malicious JS, using the logical OR || instead of an if statement. 'linux' === type || exec() Though due to a typo, it looks like this particular sample will never deploy a payload on Linux. os.type() uses the uname output, which always capitalizes Linux. Your English teacher was right! Capitalization does matter.\nEarlier this month a series of CVEs against the Robot Operating System (ROS) came across my desk. I opted not to cover them, as it was a wall of CVEs with hardly any detail in any of them. I filed it away mentally, to check back later. Its later, and I was apparently not the only observer that thought the report was quite thin on substance. Its beginning to look like the CVEs are bogus, and the research paper was a hastily reworded copy of the ROS beginner tutorial. The most convincing evidence of this is that the presumably fake researchers claimed that security updates were coming soon, while core ROS developers never received reports on the CVEs.\nAnd finally, maybe ransomware is good for one thing  keeping the lights on? Oh, no. Those lights are supposed to turn off during the day. Leiccester has had an attack of the ever-lit street lights, after a ransomware attack forced a shutdown a couple months back.", "title": "Cisco Talos Intelligence\u306b\u3088\u308b\u6700\u65b0\u306e\u8105\u5a01\u5206\u6790", "body": "\u6700\u8fd1\u306e\u30c8\u30ec\u30f3\u30c9\u306f\u3001\u4e3b\u8981\u306a\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30a2\u30d7\u30e9\u30a4\u30a2\u30f3\u30b9\u304c\u56fd\u55b6\u653b\u6483\u306b\u60aa\u7528\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3060\u3002\u30b7\u30b9\u30b3\u3082\u305d\u306e\u6700\u65b0\u306e\u88ab\u5bb3\u8005\u3067\u3001Talos Intelligence\u306e\u5831\u544a\u306b\u57fa\u3065\u3044\u3066\u3044\u308b\u3002\u653b\u6483\u306f2\u3064\u306e\u8981\u7d20\u3092\u6301\u3061\u3001\u8106\u5f31\u6027\u3092\u60aa\u7528\u3057\u3066\u3044\u308b\u304c\u3001\u521d\u671f\u30a2\u30af\u30bb\u30b9\u306f\u672a\u77e5\u3060\u3002", "titles": ["Cisco Talos Intelligence\u306b\u3088\u308b\u6700\u65b0\u306e\u8105\u5a01\u5206\u6790", "Mitel VoIP\u96fb\u8a71\u306e\u8106\u5f31\u6027\u3068\u30cf\u30c3\u30ad\u30f3\u30b0\u624b\u6cd5", "\u4eba\u5de5\u77e5\u80fd\uff08AI\uff09\u306e\u6d3b\u7528\u306b\u3088\u308b\u507d\u65d7\u904b\u52d5", "Zombie Worm\uff1aUSB\u30c9\u30e9\u30a4\u30d6\u3092\u4ecb\u3057\u305f\u81ea\u5df1\u5897\u6b96\u578b\u30de\u30eb\u30a6\u30a7\u30a2", "phpecc\u30e9\u30a4\u30d6\u30e9\u30ea\u554f\u984c\u306e\u6ce8\u610f\u559a\u8d77"]}