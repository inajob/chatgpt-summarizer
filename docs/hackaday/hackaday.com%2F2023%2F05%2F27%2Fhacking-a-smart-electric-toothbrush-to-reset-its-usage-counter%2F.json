{"pubDate": "2023-05-28T05:00:19", "original_title": "Hacking a \u201cSmart\u201d Electric Toothbrush To Reset Its Usage Counter", "link": "https://hackaday.com/2023/05/27/hacking-a-smart-electric-toothbrush-to-reset-its-usage-counter/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2023/05/nfc_toothbrush_sniffing_in_progress.jpg", "original_content": "The visible circuitry inside the brush head.\nFollowing the trend of stuffing more electronics in everyday devices, the new Philips Sonicare electric toothbrush that [Cyrill K\u00fcnzi] purchased ended up having a brush head replacement reminder feature that wasnt simply a timer in the handle or base of the unit, but ended up involving an NFC chip embedded in every single brush head containing the usage timer for that particular head. Naturally, this asked for it to be solidly reverse-engineered and hacked.\nThe NFC chip inside the brush head turned out to be an NXP NTAG213, with the head happily communicating with the NFC reader in a smartphone and the NFC Tools app. This also revealed the memory layout and a few sections that had write access protected by a password, one of which was likely to be the counter. This turned out to be address 0x24, with a few experiments showing the 32-bit value at this address counting the seconds the brush head had been used.\n\nDecoding the NFC data stream from a toothbrush using NFC-laboratory. (Credit: Cyrill K\u00fcnzi)\nNaturally, with this memory address password protected, the next step was to sniff the password using an SDR sniffer setup. After passing the resulting raw data with a gnuradio script through a lowpass filter, the resulting WAV file was decoded with the NFC-laboratory tool, allowing the traffic to be analyzed for clues. What this revealed was that the password is being passed as plaintext in the NFC data stream, making it a snap to use it to reset the counter to zero or any other desired value.\nDuring this process, [Cyrill] came across a few gotchas, including that you only get three attempts to guess the password before the NFC chip permanently refuses new authentication attempts, and the password is unique with each brush head as its generated from the NFC chips 7-byte UID, per the NXP datasheet. Fortunately, it appears that this system is only being used as a complex reminder system, and you can still use an expired head, but it does turn spent brush heads into e-waste, which is less ideal.", "title": "Philips Sonicare\u96fb\u52d5\u6b6f\u30d6\u30e9\u30b7\u306e\u6d88\u8017\u54c1\u4ea4\u63db\u30ea\u30de\u30a4\u30f3\u30c9\u6a5f\u80fd\u3092\u6539\u9020\u3059\u308b", "body": "\u30d5\u30a3\u30ea\u30c3\u30d7\u30b9\u306e\u65b0\u3057\u3044\u96fb\u52d5\u6b6f\u30d6\u30e9\u30b7\u306b\u306f\u3001\u30d6\u30e9\u30b7\u4ea4\u63db\u30ea\u30de\u30a4\u30f3\u30c0\u30fc\u306e\u6a5f\u80fd\u304c\u3042\u308a\u3001\u30bf\u30a4\u30de\u30fc\u3068\u3057\u3066\u3067\u306f\u306a\u304f\u3001NFC\u30c1\u30c3\u30d7\u304c\u7d44\u307f\u8fbc\u307e\u308c\u305f\u30d6\u30e9\u30b7\u30d8\u30c3\u30c9\u306b\u542b\u307e\u308c\u305f\u4f7f\u7528\u6642\u9593\u3092\u8ffd\u8de1\u3057\u3066\u3044\u308b\u3002\u305d\u308c\u3092\u89e3\u8aad\u3057\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u508d\u53d7\u3057\u3066\u30ab\u30a6\u30f3\u30bf\u30fc\u3092\u30ea\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002", "titles": ["Philips Sonicare\u96fb\u52d5\u6b6f\u30d6\u30e9\u30b7\u306e\u6d88\u8017\u54c1\u4ea4\u63db\u30ea\u30de\u30a4\u30f3\u30c9\u6a5f\u80fd\u3092\u6539\u9020\u3059\u308b", "\u6b6f\u30d6\u30e9\u30b7\u306e\u30d6\u30e9\u30b7\u30d8\u30c3\u30c9\u306b\u57cb\u3081\u8fbc\u307e\u308c\u305fNFC\u30c1\u30c3\u30d7\u3092\u30cf\u30c3\u30af\u3059\u308b", "\u6b6f\u30d6\u30e9\u30b7\u306eNFC\u30c7\u30fc\u30bf\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u5fa9\u53f7\u5316\u3059\u308b", "\u6b6f\u30d6\u30e9\u30b7\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u78ba\u8a8d\u3057\u3066\u3001\u30d8\u30c3\u30c9\u306e\u30ab\u30a6\u30f3\u30bf\u30fc\u3092\u30bc\u30ed\u306b\u623b\u3059", "\u6b6f\u30d6\u30e9\u30b7\u306e\u6d88\u8017\u54c1\u306e\u5ec3\u68c4\u554f\u984c\u3092\u89e3\u6c7a\u3059\u308b"]}