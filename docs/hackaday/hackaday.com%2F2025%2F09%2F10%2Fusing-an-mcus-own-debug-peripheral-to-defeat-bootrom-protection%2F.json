{"pubDate": "2025-09-10T23:00:38", "original_title": "Using an MCU\u2019s Own Debug Peripheral to Defeat Bootrom Protection", "link": "https://hackaday.com/2025/09/10/using-an-mcus-own-debug-peripheral-to-defeat-bootrom-protection/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2025/09/tamagotchi_paradise_teardown_tamagotchi_center.jpg", "original_content": "The patient hooked up for some reverse-engineering. (Credit: Caralynx, Twitter)\nReleased in July of 2025, the Tamagotchi Paradise may look somewhat like the late 90s toy that terrorized parents and teachers alike for years, but its significantly more complex and powerful hardware-wise. This has led many to dig into its ARM Cortex-M3-powered guts, including [Yukai Li] who recently tripped over a hidden section in the bootrom of the dual-core Sonix SNC73410 MCU that makes up most of the smarts inside this new Tamagotchi toy.\nInterestingly, [Yukai] did see that the visible part of the bootrom image calls into the addresses that make up the hidden part right in the reset handler, which suggests that after reset this hidden bootrom section is accessible, just not when trying to read it via e.g. SWD as the hiding occurs before the SWD interface becomes active. This led [Yukai] to look at a way to make this ROM section not hidden by using the Cortex-M3s standard Flash Patch and Breakpoint (FPB) unit. This approach is covered in the projects source file.\nWith this code running, the FPB successfully unset the responsible ROM hide bit in the\u00a0OSC_CTRL register, allowing the full bootrom to be dumped via SWD and thus defeating this copy protection with relatively little effort.\nHeading image: PCB and other components of a torn-down Tamagotchi Paradise. (Credit: Tamagotchi Center)", "title": "\u30bf\u30de\u30b4\u30c3\u30c1\u30d1\u30e9\u30c0\u30a4\u30b9\uff1a\u9006\u30b3\u30f3\u30d1\u30a4\u30eb\u306e\u5192\u967a", "body": "2025\u5e74\u7248\u30bf\u30de\u30b4\u30c3\u30c1\u306e\u8907\u96d1\u306a\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u304c\u89e3\u6790\u3055\u308c\u3001\u96a0\u3055\u308c\u305f\u30d6\u30fc\u30c8\u30ed\u30e0\u304cSWD\u3067\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u306b\u3002", "titles": ["\u30bf\u30de\u30b4\u30c3\u30c1\u30d1\u30e9\u30c0\u30a4\u30b9\uff1a\u9006\u30b3\u30f3\u30d1\u30a4\u30eb\u306e\u5192\u967a", "ARM Cortex-M3\u3092\u63a2\u308b\uff1a\u30bf\u30de\u30b4\u30c3\u30c1\u5185\u90e8\u306e\u79d8\u5bc6", "\u96a0\u3055\u308c\u305f\u30d6\u30fc\u30c8ROM\u3078\u306e\u30a2\u30af\u30bb\u30b9\u65b9\u6cd5", "\u30bf\u30de\u30b4\u30c3\u30c1\u306e\u30b3\u30d4\u30fc\u4fdd\u8b77\u3092\u6253\u7834\u3059\u308bFPB\u306e\u6d3b\u7528", "\u30bf\u30de\u30b4\u30c3\u30c1\u30d1\u30e9\u30c0\u30a4\u30b9\u306e\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u89e3\u6790\u30d7\u30ed\u30b8\u30a7\u30af\u30c8"]}