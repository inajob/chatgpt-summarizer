{"pubDate": "2024-05-31T14:00:23", "original_title": "This Week in Security: Operation Endgame, Appliance Carnage, and Router Genocide", "link": "https://hackaday.com/2024/05/31/this-week-in-security-operation-endgame-appliance-carnage-and-router-genocide/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2016/01/darkarts.jpg", "original_content": "This week saw an impressive pair of takedowns pulled off by law enforcement agencies around the world. The first was the 911 S5 botnet, Which the FBI is calling likely the worlds largest botnet ever. Spreading via fake free VPN services, 911 was actually a massive proxy service for crooks. Most lately, this service was operating under the name Cloud Router. As of this week, the service is down, the web domain has been seized, and the alleged mastermind, YunHe Wang, is in custody.\nThe other takedown is interesting in its own right. Operation Endgame seems to be psychological warfare as well as actual arrests and seizures. The website features animated shorts, a big red countdown clock, and a promise that more is coming. The actual target was the ring that manage malware droppers  sort of middlemen between initial shellcode, and doing something useful with a compromised machine. This initial volley includes four arrests, 100+ servers disrupted, and 2,000+ domains seized.\nThe arrests happened in Armenia and Ukraine. The messaging around this really seems to be aimed at the rest of the gang thats out of reach of law enforcement for now. Those criminals may still be anonymous, or operating in places like Russia and China. The unmistakable message is that this operation is coming for the rest of them sooner or later.\nCheckpoint CloudGuard\nAnd now we turn to the massive number of security and VPN appliances that got detailed exploit write-ups this week. And up first is the Watchtowr treatment of Check Point CloudGuard appliance, and the high priority information exposure CVE. This vulnerability already has a patch, so the obvious starting point is patch diffing. Thanks to a new log message in the patch, its pretty clear that this is actually a path traversal attack.\nThe vulnerable endpoint is /clients/MyCRL, which is a file download endpoint used for fetching updates to the VPN client. Based on Check Points CVSS string regarding this vulnerability, that endpoint is accessible without any authentication. The thing about this endpoint is that it takes an argument, and returns the file requested based on that argument. There is a list of allowed files and folders, but the check on incoming requests uses the strstr() C function, which simply checks whether one string contains a second.\nOne of the entries on this list was the CSHELL/ directory, which is the last piece of the puzzle to make for a nasty exploit. Send a POST to /clients/MyCRL requesting aCSHELL/../../../../../../../etc/shadow and the shadow password file is returned. This gives essentially arbitrary file read due to path traversal on a public endpoint.\nInterestingly, the vendor states that the issue only affects devices with username-and-password authentication enabled, and not with the (much stronger) certificate authentication enabled.\nTheres some definite weirdness going on with how the CVSS score was calculated, and how Check Point opted to disclose this. Cross-referencing from another vendors statement, it becomes clear that the fastest way to turn this into a full exploit is by grabbing the password hashes of users, and any legacy local users with password-only accounts can be mined for weak passwords. But make no mistake, this is an unauthorized arbitrary file read vulnerability, and the hash capture is just one way to exploit it. Attacks are ongoing, and the fix is available.\nFortinet FortiSIEM\nOne of my most/least favorite things to cover is trivial vulnerability patch bypasses. Theres nothing that disturbs and amuses like knowing that a Fortinet command injection in the NFS IP address was rediscovered in the NFS mount point field of the exact same endpoint.\nIf the botched fix wasnt bad enough, the public disclosure was almost worse. There was over a month of lag between the disclosure and reproduction of the reported issue. Then Fortinet silently rolled out patches a couple weeks later, with no disclosure at all. The CVEs were eventually released, but then claimed to be a duplicate, and published in error. And now finally the whole story is available.\nIvanti Landesk\nAnd rounding out the appliance vulnerabilities is this one in the Avanti Landesk, where a data flow can reach a strncpy() call, that takes user-supplied input for the number of bytes to copy, and a fixed buffer destination. Overflowing that buffer allows for function pointer overwrite, and writing even more data into this area eventually reaches a read-only section of memory. The write attempt triggers an exception, which bounces through a few functions, and eventually calls a pointer that has already been overwritten in the attack. A bit of Return Oriented Programming (ROP) magic, and the shellcode is marked executable and jumped into, for arbitrary code execution.\nThe flaw does require a low-privilege user account, and the vulnerable code hasnt been in the product since the 2021.1 release. Ivanti has issued a CVE, but since the last vulnerable release is outside its support window, there wont be any patches published.\nBricking 600,000 Routers\nThis one is just odd. Last year, the US ISP Windstream had about 600,000 DSL routers crash and permanently die over three days. The theory at the time was that this was a flubbed firmware upgrade, but researchers from Lumen did some quick detective work, and managed to snag malicious binaries that were actively flowing to the Windstream network.\nIt turns out that those routers were infected by the Chalubo malware, although the the initial infection vector is still unknown. Given the circumstances, its likely due to an internal breach at Windstream, possibly even an insider attack. Chalubo is designed to enable remote access, and can be used to launch DDOS attacks, among other capabilities. Its not typical for this malware to immediately wipe devices, leading to the speculation that the malware was used for plausible deniability, to shield the actual perpetrators. This has signs of being an insider attack, by a disgruntled admin at Windstream, though there is not any hard evidence at the moment.\nBits and Bytes\nLike a bad penny, North Korea has come back up with the FakePenny malware campaign. In Microsofts fun APT naming scheme, this is the work of Moonstone Sleet, whose usual strategy is to backdoor popular software and spread it however they can. In a major ransomware deployment, Moonstone Sleet requested $6.6 million in Bitcoin, which is quite the step up from previous campaigns.\nAnd lastly, Ticketmaster seems to have a 560 million user data breach on its hands. Data brokers on the Breach Forums claim to have this in a 1.3 terabyte database, and is willing to part with it for merely half-a-million dollars. There is a bit of a backstory here, as Breach Forums is run by ShinyHunters, and the whole operation was shut down by the FBI a couple weeks ago. That didnt last long, and it looks like theyre back, and back in business.", "title": "FBI\u306b\u3088\u308b\u4e16\u754c\u6700\u5927\u306e\u30dc\u30c3\u30c8\u30cd\u30c3\u30c8911 S5\u306e\u6458\u767a", "body": "FBI\u306f\u3001\u30ef\u30fc\u30eb\u30c9\u6700\u5927\u306e\u30dc\u30c3\u30c8\u30cd\u30c3\u30c8\u3067\u3042\u308b\u3068\u307f\u3089\u308c\u308b911 S5\u30dc\u30c3\u30c8\u30cd\u30c3\u30c8\u3068\u30a6\u30a9\u30c3\u30c1\u30bf\u30ef\u30fc\u4f5c\u6226\u306b\u3088\u308b\u902e\u6355\u3092\u6210\u529f\u3055\u305b\u305f\u3002\u307e\u305f\u3001CheckPoint CloudGuard\u306b\u60c5\u5831\u516c\u958b\u306eCVE\u304c\u3042\u308a\u3001CSHELL/\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u60aa\u7528\u3057\u305f\u653b\u6483\u3082\u6307\u6458\u3055\u308c\u3066\u3044\u308b\u3002", "titles": ["FBI\u306b\u3088\u308b\u4e16\u754c\u6700\u5927\u306e\u30dc\u30c3\u30c8\u30cd\u30c3\u30c8911 S5\u306e\u6458\u767a", "Operation Endgame\uff1a\u30de\u30eb\u30a6\u30a7\u30a2\u306b\u95a2\u308f\u308b\u72af\u7f6a\u8005\u306e\u902e\u6355\u3068\u53d6\u308a\u7de0\u307e\u308a", "Check Point CloudGuard\u30a2\u30d7\u30e9\u30a4\u30a2\u30f3\u30b9\u306e\u8106\u5f31\u6027\u306b\u5bfe\u3059\u308b\u653b\u6483\u3068\u4fee\u6b63", "Fortinet FortiSIEM\u306e\u8106\u5f31\u6027\u30d1\u30c3\u30c1\u56de\u907f\u306e\u554f\u984c", "Windstream\u306e\u5185\u90e8\u4fb5\u5165\u3068600,000\u53f0\u306e\u30eb\u30fc\u30bf\u30fc\u306e\u7834\u640d "]}