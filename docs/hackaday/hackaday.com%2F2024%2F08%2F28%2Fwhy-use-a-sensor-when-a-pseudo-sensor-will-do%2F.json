{"pubDate": "2024-08-28T14:00:23", "original_title": "Why Use a Sensor When a Pseudo-Sensor Will Do?", "link": "https://hackaday.com/2024/08/28/why-use-a-sensor-when-a-pseudo-sensor-will-do/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2024/08/outie80.jpg", "original_content": "Usually, when you need to sense something in a project, the answers are straightforward. Want to sense air temperature? Theres a sensor for that. Particulate content in the air? Theres a sensor for that, too. Someone sneaking up on you? Get yourself some passive infrared sensors (PIRs) and maybe a smart camera just to be sure.\nBut sometimes you can be sneaky instead, saving the cost of a sensor by using alternative techniques. Perhaps theres a way to use the hardware you already have to determine what you need. Maybe you can use statistical methods to calculate the quantity youre looking for from other measurements.\nToday, well examine a great example of a pseudo-sensor build in an existing commercial device, and examine how these techniques are often put to good use in industry.\n\nCase Study\nWhen they were introduced in 2009, Coca-Cola Freestyle dispensers were a step change in the way soft drinks were dispensed. Suddenly, you weren\u2019t limited to five or six choices on the soda fountain. You could instead sample virtually the entire Coca Cola range, all on one machine! If you\u2019re a big soda head, this was a very rad thing. If you were a maintenance tech for Coca Cola, though, you probably saw the machine differently  not as some godly fount of soda, but as a machine to be troubleshooted, repaired, and improved. Over time, it became obvious that the Freestyle unit had a high rate of Flow Control Module (FCM) replacements in the field. And yet, 50% of the FCMs returned to Coca Cola weren\u2019t faulty. There was something strange going on.\nThe problem, as revealed in a presentation from the company, was that the Freestyle machine didn\u2019t have a dedicated pressure sensor in the fluid line. If a machine had an FCM fault or a pressure loss, it would present much the same way. Thus, techs would often swap out a perfectly good FCM when the problem was actually elsewhere. The solution was obvious: there needed to be a way to sense pressure in the system, so techs could determine if an FCM was faulty or if the problem was a lack of pressure upstream.\n\nTheres a characteristic dip in the current flowing to the FCM valve when it opens\u2014and it change with pressure.\nTo address this, an engineer might have specified an off-the-shelf pressure sensor, figured out how to retrofit it to the machine, and rolled them out in the wild. Instead, Coca-Cola developed an innovative (and presumably cheaper) solution: a\u00a0 pressure pseudo-sensor, largely using equipment already on the machine.\nThe pseudo pressure sensor operates by analyzing the relationship between electrical and mechanical work within the FCM. Basically, the FCM is a valve that opens to allow the flow of fluid through the machine. Thus, the pseudo-sensor monitors the current at which the valve starts to move, a value that correlates with the pressure inside the system. As pressure increases, a characteristic V-shaped drop in current is observed; this pattern shifts as pressure changes, allowing the system to estimate the pressure based on the observed current.\nA complicated function ties pressure to the features of the FCM current curve.\nTo create the pseudo-sensor, a whole lot of data was collected from the Freestyle hardware. Over 5,000 drink pours were performed with a number of FCM modules, at pressures from 1 to 140 pounds per square inch (PSI) at 5 PSI intervals. The data collected during testing was then fed into MATLAB and Simulink in order to create a mathematical model. The aim was to link the peak size of the current feedback voltage dip measured by the current sensor, and link that to pressure. Sadly, a good reliable correlation was hard to come by.\nMore work ensued, which tied pressure to multiple timing and voltage features on the curve. These were fed into a multi-variable regression that spat out a monstrous model that calculated pressure from six features and 26 terms. It was messy, but far more accurate, and it did the job.\nFrom there, it was a simple matter of deploying the model that measured FCM current and spat our pressure measurements. It was loaded on an ARM Cortex M microcontroller and put through 3,300 tests over 10 different FCMs and two different Freestyle controller boards. The model predicted the correct pressure within a bound of +/- 10 PSI a full 85% of the time.\nAdmittedly, that would be rubbish for a proper pressure sensor. However, for a simple pseudo-sensor thats mostly just used to see if theres pressure in the system? Its pretty darn good. The pseudo-sensor software has since been deployed on Freestyle machines in the field, with work ongoing to further develop the systems diagnostics using this new tool.\nThe pseudo-sensor actually does a pretty good job!\nOther Examples\nThe simple fact is that you can often get by with indirect measurement techniques if youre constrained by things like cost, complexity, or practicality. Weve seen other work along these very lines before. Back in 2022, we covered the work of Brian Wyld, who wanted to measure the level of a body of water. Pressure and direct surface-level sensors were impractical, so he got creative. He built a rotating arm with a float on one side, and threw on a microcontroller board with an accelerometer included. The accelerometer readings were enough to allow him to figure out the angle of the float, and in turn, mathematically derive the water level as desired via simple geometry!\nWe need to measure the water level but we only have an accelerometer!No problem. Credit: Brian Wyld\nWeve also seen how this can go wrong. For example, capacitive sensors are often suggested for measuring soil moisture levels. The idea is that by measuring the capacitance of the soil, you can measure how much water content there is. The only problem is that moisture isnt the only thing that changes the capacitance of the soil.\nFor these indirect techniques to work well, what youre measuring needs to have a fairly direct correlation with what youre trying to find out. Hence why Wylds float was a success  because the float angle is directly relevant to the water level. Similarly, in Coca-Colas case, pressure was what determined the change in the current curve of the Freestyle FCM. If the curve also changed significantly with ambient temperature or some other factor, it wouldnt be possible to measure it and get out a reliable pressure value.\nUltimately, pseudo-sensors can be a useful tool to have in your engineering toolkit. They can let you achieve surprising feats with some mathematical insight and basic equipment. Just make sure theres a strong basis for what youre doing so you dont end up with junk outputs that cause you more harm than good."}