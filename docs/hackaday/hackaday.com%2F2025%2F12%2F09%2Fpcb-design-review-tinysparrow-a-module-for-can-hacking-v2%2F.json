{"pubDate": "2025-12-09T15:00:33", "original_title": "PCB Design Review: TinySparrow, A Module For CAN Hacking, v2", "link": "https://hackaday.com/2025/12/09/pcb-design-review-tinysparrow-a-module-for-can-hacking-v2/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2024/04/PCBdesign.jpg", "original_content": "A year ago, Ive design reviewed an MCU module for CAN hacking, called TinySparrow. Modules are plenty cool, and even more so when theyre intended for remaking car ECUs. For a while now, every car has heavily depended on a computer to control the operation of everything inside it  the engine and its infrastructure, the lights, and\u00a0 Sadly, ECUs are quite non-hackable, so building your own ECUs only makes sense  which is why its heartwarming to see modules intended to make this easier on the budding ECU designer!\nLast time we saw this module, it was quite a bit simpler. We talked about fixing a number of things  the linear regulator, the unprotected CAN transceiver, and the pinout; we also made the board cheaper to produce by reducing the layer count and instead pushing the clearance/track width limits. This time, were seeing TinySparrow v2 , redesigned accounting for the feedback and upgraded with a new MCU  its quite a bit more powerful!\nFor a start, its got ESD diodes, a switching-linear regulator chain for clean but efficient power supply, and most importantly, an upgraded MCU, now with USB and one more CAN channel for a total of two! Theres a lot more GPIOs to go around, too, so the PCB now uses all four of its sides for breakout out power, programming, and GPIO pads. Only a tiny bit bigger than its v1, this module packs a fair bit of punch.\nLets revisit the design, and try to find anything still left to improve  theres a few noteworthy things I found.\n\nProtection Almost Perfect\n\n\n\n\nIt took me a bit to try and find the ESD diodes mentioned in the README  I didnt notice that theyre basically the only thing on the bottom layer. This is fine  protection elements like ESD diodes can be on a different layer, and as theyre SOT-23, theyre easy to solder on post-factum. This is quite a nice placement choice, in my opinion  you can basically solder this board with cheaper single-side assembly, use ESD-less boards for your bench testing, and then simply solder the few bottom side components onto production versions!\nThere is but one hiccup with the way theyre placed. ESD diode appnotes will tell you  theres some extra considerations you can try and put into ESD diode layout. This design pulls connector tracks directly to the CAN ICs on top layer, and directly to diodes on the bottom one. Instead, you should try and route the signal through the ESD diodes  letting track inductance play in your favour, and not impeding the ESD diodes impact.\n\n\n\n\n\nFortunately, by lightly rerouting 3.3V CAN transceiver power inputs and a few surrounding signals, we can put CAN+ and CAN- signals through vias under the package, so that the signal flows in series with ESD diode pads. Similarly, the ESD diodes get vias to ground, shared with transceiver ground vias, but oh well. Its not perfect, but to my eye, its better than before, as far as ESD protection is concerned.\nAbout the only problem I can see with the reroute, is having to reshuffle USB signals, putting them closer together. However, as long as theyre intra-pair length-matched, theyll do just fine.\nVias Fit Inside Pads, But Maybe Dont?\nThis is not the only change to consider as far as signal routing goes, but its the most major one. The next issue I see, is vias  specifically, vias inside component pads.\nIve had a few run-ins with via-in-pad related problems. Previously, Ive failed to assemble some boards specifically because of via-in-pad related problems, with solder paste wicking through the board and onto the opposite side. For 0402 components I used, this made a number of boards essentially non-solderable depending on how lucky I got reflowing them, and I had to run a new board revision to get the yield up.\n\n\n\n\nThis boards files have a fair few hints about getting assembled by JLCPCB, and JLC can definitely do plugged vias, preventing any sorts of solder flowing through the board. If the designer or someone else takes the board elsewhere, however, that might no longer apply, which would be disappointing. Also, you might have to pay extra for plugging holes  just like with the previous review, lets see if we can avoid it. Most problematic areas are around the transceivers, still  especially given the board files now have a custom rule for 0.5mm via-to-via distances. This is not a constraint Ive seen actually stressed by JLCPCB, but I dont mind  with just a little bit more signal shuffling, every newly moved via landed within the 0.5mm target area.\nPinout Considerations, Again\nThe VDC pin now has GND pins to match, and in general, theres a lot more GND pins to go around  which is great! Its pretty surprising to me that the VDC pin is duplicated and its trace goes across the board on an inner layer. This is supposed to be an at least somewhat unfiltered and unprotected car power rail, after all, and I dont think thatd help things like noise integrity. Maybe this helps with testing because all the core signals are brought to the same corner, but to my eye, it has bad vibes.\nThe module could perhaps use a key pin  theres zero omissions in the outer dual-row, which leaves for a possibility of inserting this module rotated 180 degrees by accident, likely obliterating at least something on the module. If these modules are ever meant to be swapped during testing, i.e. using machined headers, Id try and remove one of the pins from the equation  theres a NC pin in one of the corners already, thankfully.\n\n\n\n\nTheres a pair of 3.3 V signals and GND signals on the opposite sides of each other. This is geometrically satisfying pinout-wise, and, it would short-circuit the modules onboard regulator if the modules ever rotated inserted 180 degrees. This is generally harmless with modern modules, but it could very well make the switching or the linear regulator heat up to finger-burning temperatures  last thing you need when trying to remove a module inserted incorrectly!\nThankfully, at the top, theres a few unconnected pads, so perhaps GND and NC could swap places, making sure that 3.3 V lands on NC once rotated 180 degrees. The VDC pads could perhaps use the same consideration, but Im comfortable leaving those as homework.\nMoving Forward\nIts a joy to see how much the TinySparrow module has grown in its v2. From vastly improved layout to higher consideration given to design rules, nicer silkscreen, and a way more powerful MCU while at it, its that much more of a viable heart for a somewhat modern car, and itd be quite nice to see some boards utilizing it in the future. I hope this review can help!\n\n\n\n\nAs usual, if you would like a design review for your board, submit a tip to us with [design review] in the title, linking to your board files. KiCad design files strongly preferred, both repository-stored files (GitHub/GitLab/etc) and shady Google Drive/Dropbox/etc .zip links are accepted.", "title": "- TinySparrow v2: \u8eca\u4e21ECU\u30cf\u30c3\u30ad\u30f3\u30b0\u306e\u65b0\u305f\u306a\u4e00\u6b69", "body": "TinySparrow v2\u306f\u3001\u5f37\u5316\u3055\u308c\u305fMCU\u3092\u642d\u8f09\u3057\u3001\u8ecaECU\u306e\u8a2d\u8a08\u3092\u5bb9\u6613\u306b\u3057\u307e\u3059\u3002\u30c7\u30b6\u30a4\u30f3\u3082\u6539\u5584\u3055\u308c\u3001\u4fdd\u8b77\u6a5f\u80fd\u304c\u5411\u4e0a\u3057\u307e\u3057\u305f\u3002", "titles": ["- TinySparrow v2: \u8eca\u4e21ECU\u30cf\u30c3\u30ad\u30f3\u30b0\u306e\u65b0\u305f\u306a\u4e00\u6b69", "- \u6539\u826f\u3055\u308c\u305fESD\u4fdd\u8b77\u6a5f\u80fd\u3092\u642d\u8f09\u3057\u305fTinySparrow\u30e2\u30b8\u30e5\u30fc\u30eb", "- \u8eca\u4e21\u5411\u3051ECU\u30c7\u30b6\u30a4\u30f3\u306e\u305f\u3081\u306e\u30d1\u30ef\u30d5\u30ebMCU\u3092\u5b9f\u73fe", "- \u30d4\u30f3\u914d\u7f6e\u3068\u4fe1\u53f7\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u6539\u826f\u70b9\u3092\u63a2\u308b", "- DIY\u96fb\u5b50\u5de5\u4f5c\u306b\u6700\u9069\u306aTinySparrow\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u9032\u5316"]}