{"pubDate": "2023-06-26T14:00:04", "original_title": "Meshtastic for the Greater Good", "link": "https://hackaday.com/2023/06/26/meshtastic-for-the-greater-good/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2023/06/Meshtatic.jpg", "original_content": "Last week, my city was hit by a tornado. Thats not surprising here in Oklahoma, and thankfully this event was an F0 or possibly even an EF0  a really weak tornado. Only a couple roofs collapsed, though probably half the houses in town are going to need roof repairs, thanks to the combination of huge hail and high winds. While it wasnt too bad, power did go down in a few places around town, and this led to an interesting series of events.\nChat messages were coming in like this: That was a [power] flicker, yeah. Even took down my Internet. Followed by Whee, [fiber Internet] got knocked out and now Starlink has too many clouds in the way. And after ten minutes of silence, we got a bit worried to see Time to hide under a bed.  Is cell service back? It is a bit spooky to think about trying to help neighbors and friends after a disaster, in the midst of the communication breakdown that often follows. If he had needed help, and had no working communications, how long would it have taken for us to go check on him?\n\nHow do you stay connected here?avivi, CC BY-SA 2.0\nI had already been exploring an open source project that might be able to help. A follower described a problem where communication could be cut off in the midst of a large protest in her home country, and she needed a way to stay connected in a crowd.\nOne of the possible solutions was Meshtastic, an encrypted wireless protocol that uses meshing to distribute messages and location data. It runs on a few different development boards, and some of the hardware is surprisingly affordable. For instance, the WisBlock Meshtastic starter kit is a mere $24.99. Use a USB-C cable to hang that off your phone, and you can connect to nearby metastatic channels, or create your own private channel.\nThe Magic\nThe Meshtastic radio magic comes from LoRa, a wireless protocol running on the sub-1 GHz bands. One of the winning features of that band is that no amateur license is required, up to a 1 W broadcast strength. If you have your Ham license, feel free to turn up the power  but with the caveat that amateurs cant use encryption. And thats one of Meshtastics features; it uses AES encryption to keep conversations private. More on the configuration in a bit.\nI hear you radio geeks scoffing, A measly watt?\u00a0 But people have managed 128 mile (206 km) LoRa contacts on quite a bit less than that full watt. Yes, that test did involve a weather balloon, but the second-place test was a still-respectable 103 mile (166 km) distance managed peak-to-peak across water. You may notice that both records required elevation. The 915 MHz band that Meshtastic targets is still pretty dependent on line-of-sight  no ionosphere skipping here. And with only a 1 watt output power, were not blasting though much earth.\nSo to make up for the less-than-stellar propagation of the frequency band, the Meshtastic protocol makes every node a potential repeater. If your radio can talk to your buddys radio up on the hill, that device works as a repeater, and rebroadcasts the packet, giving your message a much wider reach. By default, each packet is limited to three hops, and the protocol tries to be smart about not flooding the aether with useless echoes. But if you can get a couple of radios in elevated locations across your area, you can manage pretty good coverage.\nUsefullness\nOK, so what can you do with it? Keep in mind that LoRa isnt winning any throughput contests. No streaming video or file-sharing here. Meshtastic works best when sending text messages, either directly to another radio, or to a shared channel. And if your radio knows where its at, it can send location data every few minutes to the primary shared channel. There are other modules, like sending telemetry data like temperature and humidity across the network, or a rather impressive experimental module that sends low bit-rate audio across the aether. The system was originally designed for friends going hiking, camping, or even hang gliding together.\nRadio on the Hill\nI have several use-cases where Meshtastic just might be the killer app. One is disaster recovery. If I can talk a few friends into stashing a radio, if tornado really comes and ruins our day, well have a backup communication net to organize getting help where its needed. But on a day-to-day basis, Im much more interested in giving one of the battery-powered radios with each of my kids, before letting them out the door. Suddenly dont see the kid where expected? Ping the radio for a location update.\nI have a 6 dBi antenna about 20 feet up in my back yard, trying to get all the range I can. I regularly get three and a half miles of coverage across town, with a few dead zones in valleys. Talking someone in the right spot into a repeater will make quite a difference on that front. And on the far end, Ive established a pretty robust 10 mile link from the local mountain-top. Line-of-sight is king.\nGetting Started\nWhen I first discovered Meshtastic, the hook that really got me interested was that low price. A pair of WisBlock kits or Lilygo T-Beams gets you started, but the performance of the little PCB antenna isnt amazing. And its nice to have a GPS module and battery for the radio. And of course youll want to 3d-print a case for it, because who wants to carry around a raw PCB and dangling antenna? There are some cases and even pre-assembled kits on Etsy and Tindie. And Rokland is one of the favored suppliers of the Meshtastic devs.\n\nFor a bit more power, theres the Station G1 by BQ Consulting that has an amplifier scaling output power all the way up to 3.5 W, if you want to turn off encryption and send your ham radio call-sign with each packet. To keep encryption on, youll need to limit the output to a single watt. Though my testing really indicates that the line of sight becomes a problem long before transmit power, and turning up the power doesnt help that situation dramatically.\nFrom there, you just need two or more radios with a shared channel. By default, Meshtastic radios use the LongFast channel, with a shared blank encryption key, as sort of a public channel. Something to be aware of is that if you broadcast location information, it goes out over the Primary channel. So you might want to set a private channel with a unique encryption key as your primary, and define the LongFast channel as a secondary, to participate in the public channel. To do that, in Lora settings, set the channel number to 20, and add a secondary channel named LongFast with the pre-shared key set to AQ==.\nAnd with that, youre set. You can track a vehicle or person, send text messages that dont rely on the Internet or Cellular network, and even do a few extra tricks. One of those more interesting tricks is the Meshtastic support for sending packets on to a MQTT server. Thats a topic for another day.\nIf youre looking for more information, there was a great FLOSS Weekly interview with a couple of the Meshtastic devs that I can recommend with some admitted bias. The official Meshtastic website and Github repository are good startign points, too. Beyond that, Ive been peppering the Meshtastic Discord with questions, suggestions, and bug reports for over a month now, and its been a very welcoming community. If you have any questions, dive in. And look forward to more fun to be had with Meshtastic integrating with other projects."}