{"pubDate": "2024-03-19T17:00:38", "original_title": "PCB Design Review: ESP32-S3 Round LCD Board", "link": "https://hackaday.com/2024/03/19/pcb-design-review-esp32-s3-round-lcd-board/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2016/09/resistor.jpg", "original_content": "For our next installment, I have a lovely and daring PCB submitted by one of our readers, [Vas]. This is an ESP32-S3 board that also has an onboard round TFT display, very similar to the one we used on the Vectorscope badge. The badge is self-sufficient  it has an ESP32, it has a display, a programming connector, two different QWIIC ports you could surely use as GPIOs  whats not to love?\nThis is a two-layer board, and I have to admit that I seriously enjoy such designs. Managing to put a whole lot of things into two layers is quite cool in my book, and I have great fun doing so whenever I get the opportunity. Theres nothing wrong with taking up more layers than needed  in fact, if youre concerned about emitted/received noise or you have high-speed interfaces, four-layer is the way to go. But making complex boards with two layers is a nice challenge, and, it does tend to make these boards cheaper to manufacture as a very nice bonus.\nLets improve upon it, and support [Vas]s design. From what I can see looking at this board, we can help [Vas] a lot with ease of assembly, perhaps even help save a hefty amount of money if they go for third-party PCBA instead of sitting down with a stencil  which you could do with this board pretty easily, since all of the components on it, save for the display, are the ones youd expect JLCPCB to stock.\n\nOpen It Up\nThe board is designed in Eagle, but I was surprised just how well it imported into KiCad using nothing else but the built-in File=Import Non-KiCad Project dialog. As an Eagle refugee in the past, it warms my heart, because I know Eagle could never reach this sort of featurefulness at the time.\n<!--more-->\n\n\n\n\nAfter you import it, open the board viewer and press B to refill the GND zones  the board might look a little scuffed, but Id be comfortable ordering one for myself as-is! The schematic has imported pretty well too. There are some labels that didnt import neatly, but theres nothing I can see that is broken. All the footprint names are present too  helpful for reviewing component choices.\nOnce again, the board is impressive. I like it a lot  it includes some great features, like ESD diodes on the RST and BOOT buttons for the ESP, separation of the USB VBUS and GND, and a JST-SH power connector for any portable applications. It also has some component choices we ought to discuss.\nComponent Choices\nOn the left, you can see the two QWIIC connectors that surely work as GPIO expansions in a pinch, and on the right, theres a JST-PH connector that has power. Next to the QWIIC connectors, you will notice some tiny components  yep, those are 0201 resistors, and there are quite a few of these. The problem with these is that theyre a bother to assemble compared to everything else on the board, they can significantly add to cost if you do PCBA. And they are not even strictly necessary in places where theyre found.\nHeres my take on the resistors. If you are worried that the resistor will interfere with the JST-SH plug being inserted, worry not  this appears to be a footprint for a vertical JST-SH SMD socket, I dont see how it could be otherwise, considering the 0201 placement. Now, this is not the only place where 0201 resistors are found  lets take a look at the footprint assignment window for a summary.\n\n\n\n\nThere are some things that immediately spring out. For all 0201 resistors, Ive taken a look at the board, and its not clear to me why they couldnt be 0402  especially given how small Kicads 0402 footprints are compared to Eagles 0402 footprints. Also, Ive replaced all capacitors 1 uF and lower to 0402, and all capacitors larger than that to 0603. Ive left some resistors 0603 or higher, in places where it looks like they could be replaced by a ferrite bead in practice, which is what I think was the designers intention with both microUSB power/data pins and the 3.3 V input on the ESP.\nLast thing I will note  its not clear to me why I2C bus pullups are different, but I trust the boards creator. However, 1 k\u03a9 seems way too intense of a value for I2C, from what Ive seen, especially given so many QWIIC sensors have pullups on them too. So, you could easily replace one of the pullup pairs, or unite them both to something like 1.8 k\u03a9, the I2C pullup value used by Raspberry Pi with great success, or 3.3 k\u03a9, the default QWIIC value.\nComponent Placement\nWhen I flip this board in 3D viewer (hotkey:F), theres one thing that instantly comes to my mind, and its that the bottom side could be completely clean! In fact, if I understand it right, its best that it would be  otherwise, there would be parts under the TFT display, which I feel like would be a mechanical failure point. And parts under the display, there indeed are  at three points, so unless you make a custom standoff or use a healthy amount of foam tape, itll be a mechanical bother. Lets see if we can fix this.\nI am surprised to see that Eagle footprints are noticeably larger than their KiCad footprints  specifically the 0402s. On such a cramped board, this really makes a difference, as I will show later. Lets tackle the top left corner with ESP power filtering first. After replacing the footprints and stacking them closer together, it becomes possible to move the RST capacitor and pullup, freeing up one of the three spots on the back.\nNext, a second spot on the back, near the microUSB connector. First, there are two 0 \u03a9 resistors on the USB pair on the back  with a bit of power trace pushing on the top layer, this is moveable to the front, together with the ESD diodes to ground also on the back layer. The three resistors you can see next to them, however, are a bit of a different story, because they belong to the switching regulator.\nThe main problem with the switching regulator section is that the feedback resistors are on the other side. If youre doing a 2-layer design with a switcher, and this design has two of them, its important to provide the switcher with a good ground plane  something that Im inclined to say feels missing here. However, there isnt much space  or, there wasnt, until I replaced the footprints with KiCad ones, and a bunch of space has freed up on the right.\nWith that space, we can do great things already  but we can free up even more! Heres something you might notice  theres no apparent reason why GPIO48 and GPIO45 have to be used, so I opt to remap them to different pins. This lets us remove the entire bottom row of the ESP pads, since theres no reason to solder to them  this is a good technique if you want to put many traces onto two layers. This lets me replace it with a silkscreen rectangle. This might belong on the Fab layer, but its easier for me to hide F.Fab and B.Fab right now to reduce visual clutter, and I need to see this  it can be easily moved later.\nWith the free space, we can move power traces to the top, which lets us move the switching inductor and the switching chip to the right  moving the feedback resistors to a top layer, and clearing up the ground plane on the back. Now, the only thing left is the LED driver for the display backlight  just one chip and one inductor.\nThis is something Im inclined to leave as an exercise to the reader  Ive shown quite a bit already. Im also wondering about the actual characteristics of the display. Does it actually need a boost driver for the LED, or is it sufficient to add a series resistor and power it from the input power rail? If the display has a single-series LED backlight, the driver shouldnt be necessary, and it isnt uncommon to drive such backlight using an NPN transistor and a GPIO.\n\n\n\n\nAnd a last note about something that might bite  the MicroUSB port has a PCB edge marking, but it isnt actually at the edge. This means you cant use MicroUSB connectors that have lips, so you have to watch out that you dont accidentally buy some of those  they are popular. This is also something that wouldnt be an issue with USB-C, and manufacturing boards with microUSB in 2024 is a bit pass\u00e9  but Git says this board was designed two years ago, so I will give it a pass.\nCheaper, Flatter, Lovely As Ever\nIn all, this PCB review should help decrease the production cost for the board. We replaced 0201 parts with bigger and cheaper parts, united the BOM values, and moved bottom layer parts onto the top layer  at least, most of them, but this should already let us avoid dual-side assembly fees. Cleaning up the switching regulator design should help a lot with electrical noise as well as performance.\nI thank [Vas] for sharing this design with us, and I hope that this design got its shot at existence as a real-world PCB already  the round displays are nice to play with, and I can imagine it being a pretty fun badge to wear, especially paired with a suitable battery!", "title": "ESP32-S3\u30dc\u30fc\u30c9\u306e\u30c7\u30b6\u30a4\u30f3\u3068\u6539\u826f", "body": "\u8aad\u8005\u306e[Vas]\u304c\u63d0\u51fa\u3057\u305fESP32-S3\u30dc\u30fc\u30c9\u306b\u3064\u3044\u3066\u306e\u8a18\u4e8b\u30022\u5c64\u306e\u30dc\u30fc\u30c9\u3067\u3042\u308a\u3001\u591a\u304f\u306e\u6a5f\u80fd\u3092\u51dd\u7e2e\u3057\u305f\u8a2d\u8a08\u3002\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306e\u914d\u7f6e\u3084\u6539\u5584\u70b9\u306b\u8a00\u53ca\u3057\u3001\u57fa\u76e4\u751f\u7523\u30b3\u30b9\u30c8\u3092\u524a\u6e1b\u3059\u308b\u63d0\u6848\u3092\u884c\u3063\u3066\u3044\u308b\u3002", "titles": ["ESP32-S3\u30dc\u30fc\u30c9\u306e\u30c7\u30b6\u30a4\u30f3\u3068\u6539\u826f", "2\u5c64PCB\u306e\u6280\u5de7\u3068\u8a2d\u8a08\u30c1\u30e3\u30ec\u30f3\u30b8", "\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u9078\u5b9a\u3068\u52b9\u7387\u7684\u306a\u30a2\u30bb\u30f3\u30d6\u30ea", "KiCad\u3092\u7528\u3044\u305f\u30c7\u30b6\u30a4\u30f3\u30a4\u30f3\u30dd\u30fc\u30c8\u3068\u6539\u5584", "\u914d\u7dda\u3068\u8a2d\u8a08\u306e\u6700\u9069\u5316\u306b\u3088\u308b\u88fd\u9020\u30b3\u30b9\u30c8\u524a\u6e1b"]}