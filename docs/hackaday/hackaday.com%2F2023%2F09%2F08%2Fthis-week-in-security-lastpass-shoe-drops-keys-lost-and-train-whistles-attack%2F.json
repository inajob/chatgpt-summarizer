{"pubDate": "2023-09-08T14:00:24", "original_title": "This Week in Security: LastPass Shoe Drops, Keys Lost, and Train Whistles Attack", "link": "https://hackaday.com/2023/09/08/this-week-in-security-lastpass-shoe-drops-keys-lost-and-train-whistles-attack/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2016/01/darkarts.jpg", "original_content": "There has been a rash of cryptocurrency thefts targeting some unexpected victims. Over $35 million has been drained from just over 150 individuals, and the list reads like a whos-who of the least likely to fall for the normal crypto scams. There is a pattern that has been noticed, that almost all of them had a seed phrase stored in LastPass this past November when the entire LastPass database was breached.\nThe bulletproof security of the LastPass system depends in part on the rate limiting of authenticating with the LastPass web service. Additionally, accounts created before security improvements in 2018 may have had master passwords shorter than 12 characters, and the hash iterations on those accounts may have been set distressingly low. Since attackers have had unrestricted access to the database, theyve been able to run offline attacks against accounts with very low iterations, and apparently that approach has been successful.\nMicrosofts Signing Key\nYou may remember a story from a couple months ago, where Microsoft found the Chinese threat group, Storm-0558, forging authentication tokens using a stolen signing key. There was a big open question at that point, as to how exactly an outside group managed to access such a signing key.\nThis week we finally get the answer. A crash log from 2021 unintentionally included the key, and Microsofts automated redaction system didnt catch it. That crash dump was brought into development systems, and an engineers account was later accessed by Storm-0558. That key should not have worked for enterprise accounts, but a bug in a Microsoft key validation allowed the consumer systems key to work for enterprise accounts. Those issues have been fixed, but after quite a wild ride.\nMSI Keys Demonstrated\nIn March MSI suffered a major breach, and among the pilfered data was MSIs BootGuard private key. The Hardcore Matrix team has put together an attack chain that uses these keys to inject a custom module into the UEFI boot image.\n\nForgot The Key Generation\nIf theres anything worse than losing your keys, its forgetting to generate them in the first place. VMware Aria has a CVSS 9.8 vulnerability, which boils down to a shared SSH key across all installs from version 6.0 to 6.10.\nProton\nResearchers at Sonar set their sights on Proton Mail, and found some impressive issues, that chained together results in running unsanitized JavaScript from inside an incoming email, with access to the entire logged-in account. Proton Mail is carefully built to avoid exactly this sort of attack, so it takes some clever work to pull it off.\nThe first observation is that  tags in incoming emails get replaced with   after the code has run through the HTML sanitizer. SVG data is very different from normal HTML, and making that change has some unexpected effects. Inside SVG tags, quotation marks are absolute, and additional tags inside of quotes are ignored. But in regular old HTML, tags are absolute, and quotation marks are mere suggestions. This means that JavaScript can be smuggled inside of an SVG element.\nIts not that easy, as Proton Mail also uses iframe sandboxing and Content Security Policy (CSP). One of the allowed contents, however, is the script-src blob. Thats intended to be used for temporary content that uses a random UUID to refer to it. The key to making use of this is to send two emails to the victim. One email has a JavaScript file as an attachment, which automatically gets converted into a blob, but not executed. That email also has CSS in it, that uses the cross-fade() function to leak the temporary name of the blob one byte at a time, by making a series of requests back to a malicious server. Using the leaked name, the attacker sends a second email, that executed the blob from the first.\nIf the victim is running Safari, the CSP is written to allow access to the entire page at this point. On other browsers, Further user interaction is required, in the form of following a link to open a new tab. The flaw was reported in June, and a fix went live in July. The solution was the simple one, to just turn off SVG support altogether.\nOof Barracuda\nWe missed this update last week, but the Barracuda saga continues. The latest is this FBI warning (pdf), that as of August 23, fully patched Barracuda ESG appliances were still being compromised. This vulnerability is triggered by these email gateways unpacking a compressed file to scan it for malware, and as such doesnt require any special configuration or open ports.\nThis leads us to the unfortunate situation where Barracuda has announced that every ESG appliance in production should be assumed to be compromised. Theres a bit of disagreement from Mandiant, who maintain that there have been no confirmed compromises of patched devices after the May 20th update.\nTrain whistle Capn Crunch Style\nYou may have seen headlines about a cyber-attack against Polands rail network, with statements like Hackers broke into railway frequencies to disrupt traffic. Except, this has more in common with phone phreaking than anything cyber. Rather than breaking into radio frequencies with some elaborate attack, this is just transmitting three audio tones over a 150.100 MHz radio signal. No encryption, no authentication. No word on whether the audio was produced using a toy whistle found in cereal boxes.\nBits and Bytes\nIf youre one of the many fans of Notepad++, youll want to be a bit extra careful about opening untrusted files with this beloved text editor. A set of four vulnerabilities have been found in the program, with the worst having the potential to lead to remote code execution (RCE). Unfortunately, fixes have not landed in the project, and these issues are being released by Githubs Security Lab due to 90+ days having passed since disclosure.\nThe Openfire chat server has an authentication bypass issue in its admin console, and while patches are available, this vulnerability is actively being exploited in the wild, but this vulnerability apparently isnt sufficiently enterprise to have garnered much attention.\nSomeone has apparently had enough of spyware, as two separate mobile-centric spyware operations were breached, wiped, and shut down last month.\nIf you make kids snacks, and put a URL on the box, please make sure you dont let the domain expire. Because otherwise, someone will come along and claim the domain, and maybe put something really nasty there. Thats the basic story behind a recall of Paw Patrol snacks in the UK. The original manufacturer ceased business in 2022, and when their old domain expired and got bought by a porn site, the inevitable happened.\nAnd finally, the DEA has fallen for a classic cryptocurrency scam. In moving seized cryptocurrency around, DEA agents sent a small value from one account to another. A scammer quickly created an address where the first five and last four values matched the legitimate address  two addresses that would look identical at a quick assessment. And the bait was taken, losing the DEA around $50,000. Oops!", "title": "- \u4e88\u60f3\u5916\u306e\u88ab\u5bb3\u8005\u306b\u5bfe\u3059\u308b\u4eee\u60f3\u901a\u8ca8\u6ce5\u68d2\uff1a35\u5104\u30c9\u30eb\u306e\u640d\u5931", "body": "\u6697\u53f7\u901a\u8ca8\u306e\u76d7\u96e3\u304c\u5897\u3048\u3066\u304a\u308a\u300135\u5104\u30c9\u30eb\u4ee5\u4e0a\u304c150\u4eba\u4ee5\u4e0a\u304b\u3089\u6d41\u51fa\u3057\u3066\u3044\u307e\u3059\u3002\u88ab\u5bb3\u8005\u306f\u4e88\u60f3\u5916\u306e\u4eba\u3005\u3067\u3001\u5f7c\u3089\u306e\u307b\u3068\u3093\u3069\u306f\u6628\u5e7411\u6708\u306bLastPass\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u4fb5\u5bb3\u3055\u308c\u305f\u6642\u306b\u30b7\u30fc\u30c9\u30d5\u30ec\u30fc\u30ba\u3092\u4fdd\u5b58\u3057\u3066\u3044\u307e\u3057\u305f\u3002", "titles": ["- \u4e88\u60f3\u5916\u306e\u88ab\u5bb3\u8005\u306b\u5bfe\u3059\u308b\u4eee\u60f3\u901a\u8ca8\u6ce5\u68d2\uff1a35\u5104\u30c9\u30eb\u306e\u640d\u5931", "- LastPass\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4fb5\u5bb3\u304c\u539f\u56e0\u306e\u554f\u984c\u304c\u660e\u3089\u304b\u306b", "- Microsoft\u306e\u7f72\u540d\u30ad\u30fc\u306e\u554f\u984c\uff1a\u56fd\u5bb6\u30b0\u30eb\u30fc\u30d7\u304c\u30a2\u30af\u30bb\u30b9", "- MSI\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30ad\u30fc\u304c\u6d41\u51fa\uff1a\u653b\u6483\u306e\u8a73\u7d30\u304c\u660e\u304b\u3055\u308c\u308b", "- Proton Mail\u306e\u8106\u5f31\u6027\uff1a\u4e0d\u6b63\u306aJavaScript\u304c\u5b9f\u884c\u3055\u308c\u308b"]}