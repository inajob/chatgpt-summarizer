{"pubDate": "2024-02-02T15:00:25", "original_title": "This Week in Security: Glibc, Ivanti, Jenkins, and Runc", "link": "https://hackaday.com/2024/02/02/this-week-in-security-glibc-ivanti-jenkins-and-runc/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2016/01/darkarts.jpg", "original_content": "Theres a fun buffer overflow problem in the Glibc __vsyslog_internal() function. This ones a real rollercoaster, because logging vulnerabilities are always scary, but at a first look, it seems nearly impossible to exploit. The vulnerability relies on a very long program name, which can overflow an internal buffer. No binaries are going to have a name longer than 1024 bytes, so theres no problem, right?\nLets talk about argv. Thats the list of arguments that gets passed into the main() function of every Linux binary when it launches. The first string in that list is the binary name  except thats a convention, and not particularly enforced anywhere. What really happens is that the execve() system call sets that list of strings. The first argument can be anything, making this an attacker-controlled value. And it doesnt matter what the program is trying to write to the log, because the vulnerability triggers simply by writing the process name to a buffer.\nThere is a one-liner to test for a vulnerable Glibc:\nexec -a `printf %0128000x 1` /usr/bin/su  /dev/null\nand the Qualys write-up indicates that it can be used for an escalation of privilege attack. The good news is this seems to be a local-only attack. And on top of that, a pair of other lesser severity issues were found and fixed in glibc while fixing this one.\n\n48 Hours to Rip and Repave\nWeve briefly covered the vulnerabilities in Ivanti Connect Secure/Policy Secure devices, but it seems weve failed to properly grasp the severity of this threat, given the latest Emergency Directive from CISA. Issued January 31st, it gives all of 48 hours for every US government network to yank the power cord from these devices. This is significant, as weve seen plenty of directives to install updates or mitigations, but this may be the first directive that includes full removal.\nAnd then the instructions for getting a device back into service are fairly extreme, too. Complete factory reset, revoke all the certificates associated with the machine, and generally assume that your box has been completely owned. It seems like CISA knows something that maybe we dont, and its not great news for Ivanti users. Do note that this even applies to devices that have had the XML mitigation applied. Yikes.\nJenkins\nThe Jenkins automation server just fixed a pair of vulnerabilities, both of which have the potential to be pretty bad. Up first is a data leak, where a the parseArgument function will interpret an @ symbol to mean expanding a file location into a series of arguments. It works out to provide a file read primitive, which can be accessed by any users with read permissions.\nTheres also a cross-site scripting problem with the websockets Command Line Interface functionality. Some of the normal protections against XSS problems arent applied to websockets connections, so a malicious link can trigger CLI actions when clicked by an authenticated user.\nBoth of these issues were fixed in 2.442 released on the 24th, but the file read issue now has Proof of Concept code out in the wild. Its likely not long until those are used in attacks, if it hasnt happened already.\n\nThis vulnerability in #Jenkins is serious CVE-2024-23897\nPOCs have been published https://t.co/nGtbf8fehdhttps://t.co/pzY0NSL5bA\nreport by @SonarSource https://t.co/VNAUg2PDN8 pic.twitter.com/vbiWGmj47M\n Florian Roth (@cyb3rops) January 26, 2024\n\nLeaky Vessels\nResearchers at Snyk have identified a quartet of vulnerabilities that threaten the sandboxing guarantees of modern containers. Theres one that is in the runc binary itself, where a host file descriptor can be leaked into the container process, exposing the entire host filesystem. This means a docker run or docker build command could have access to the outside system. The other three issues are specific to Docker Buildkit, and also allow system access of varying degrees.\nThere arent any signs of active exploitation, and the runc program has been updated. Snyk has also released a pair of tools to look for Docker images attempting to exploit these issues.\nBits and Bytes\nIts another chess hack, but thankfully this time theres no buzzers in shoes or other places, this is an XSS of chess.com. This one is a throwback to the original Myspace worm  gaining friends automatically on pageview. The next step was actually running JS on pageview and getting cookie data out. Check and mate.\nThe FBI hit the killswitch on a few hundred compromised Cisco and Netgear routers in December. These are Internet-connected devices that are either end-of-lifed or simply unpatched, and have been compromised and made part of a botnet. The most fascinating bit is that the disinfecting process included adding a mitigation to prevent reinfection, but one that only lasts til the next reboot. Maybe next time we can get the FBI to upgrade those hacked routers to OpenWRT instead.\nThe Fortra GoAnywhere Managed File Transfer solution has joined the ranks of the critically vulnerable, as versions 6 and 7 of this software allow unauthorized users to create administrator users via an authentication bypass. The fix landed in 7.4.1, and this is the sort of juicy vulnerability that ransomware groups just love to take advantage of.\nAnd this is your reminder that not every reported data breach is real, and not every online fake is the result of AI. Europcar.com was reported to have lost records for fifty million customers, with the database being offered in the usual places. Except the data didnt make any sense, with plenty of those users apparently living in imaginary cities. The explanation quickly came out, that it was obviously ChatGPT-generated data  which is apparently now describes any faked data, as this has no signs of actually being produced by a Large Language Model. Ah well.", "title": "Glibc\u306e\u30d0\u30c3\u30d5\u30a1\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u554f\u984c\u304c\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "body": "Glibc\u306e\u30d0\u30c3\u30d5\u30a1\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u30d0\u30b0\u3067\u7279\u6a29\u30a8\u30b9\u30ab\u30ec\u30fc\u30b7\u30e7\u30f3\u653b\u6483\u53ef\u80fd\u3001Ivanti Connect Secure/Policy Secure\u306e\u8106\u5f31\u6027\u306748\u6642\u9593\u4ee5\u5185\u3067\u306e\u30ea\u30da\u30a2\u30d6\u53ef\u80fd\u3002Jenkins\u306b\u3082\u30c7\u30fc\u30bf\u30ea\u30fc\u30af\u3068\u30af\u30ed\u30b9\u30b5\u30a4\u30c8\u30b9\u30af\u30ea\u30d7\u30c6\u30a3\u30f3\u30b0\u306e\u554f\u984c\u3042\u308a\u3002Snyk\u304cDocker\u306e\u8106\u5f31\u6027\u3092\u7279\u5b9a\u3002\u30c1\u30a7\u30b9\u30c9\u30c3\u30c8\u30b3\u30e0\u304cXSS\u88ab\u5bb3\u3001FBI\u304c\u30b3\u30f3\u30d7\u30ed\u30df\u30b9\u3055\u308c\u305f\u30eb\u30fc\u30bf\u30fc\u3092\u7121\u52b9\u5316\u3002Fortra GoAnywhere\u3082\u8106\u5f31\u6027\u3042\u308a\u3002Europcar.com\u306e\u30c7\u30fc\u30bf\u6f0f\u3048\u3044\u306f\u507d\u60c5\u5831\u3067\u3057\u305f\u3002", "titles": ["Glibc\u306e\u30d0\u30c3\u30d5\u30a1\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u554f\u984c\u304c\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "Ivanti Connect Secure/Policy Secure\u30c7\u30d0\u30a4\u30b9\u306e\u8106\u5f31\u6027\u304c\u6df1\u523b", "Jenkins\u306e\u81ea\u52d5\u5316\u30b5\u30fc\u30d0\u30fc\u306b\u30c7\u30fc\u30bf\u30ea\u30fc\u30af\u3068XSS\u306e\u554f\u984c\u304c\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "\u30b3\u30f3\u30c6\u30ca\u306e\u30b5\u30f3\u30c9\u30dc\u30c3\u30af\u30b9\u4fdd\u8a3c\u3092\u8105\u304b\u3059\u8106\u5f31\u6027\u304c\u767a\u898b\u3055\u308c\u307e\u3057\u305f", "\u4e0d\u6b63\u306a\u30e6\u30fc\u30b6\u30fc\u304cGoAnywhere Managed File Transfer\u3067\u7ba1\u7406\u8005\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u53ef\u80fd"]}