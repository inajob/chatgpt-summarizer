{"pubDate": "2023-12-13T18:00:31", "original_title": "PCIe For Hackers: External PCIe And OCuLink", "link": "https://hackaday.com/2023/12/13/pcie-for-hackers-external-pcie-and-oculink/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2023/11/hadimg_pcie_oculink_feat.jpg", "youtube": "https://www.youtube.com/watch?v=q5xvwPa3r7M", "original_content": "Weve seen a lot of PCIe hacks on Hackaday, and a fair few of them boil down to hackers pulling PCIe somewhere it wasnt meant to be. Today, we routinely can find PCIe x1, x2 and x4 links sitting around in our tech, thanks to the proliferation of things like NVMe SSDs, and powerful cheap SoCs that make PCIe appear at your fingertips.\nIn the PCIe For Hackers series, weve talked about PCIe and how cool it is, all the benefits it has for hackers, gave you layout and interconnection rules, and even went into things like PCIe switches and bifurcation. However, theres one topic we didnt touch much upon, and thats external PCIe links.\nToday, Id like to tell you about OCuLink  a standard that hackers might not yet know as an option whenever we need to pull PCIe outside of your project box, currently becoming all that more popular in eGPU space. Essentially, OCuLink is to PCIe is what eSATA is to SATA, and if you want to do an eGPU or an external PCIe socket, OCuLink could work wonders for you.\nRespectable Capabilities\nJust like any high-speed standard, PCIe has some tight requirements when things get fast. Even though PCIe is known to be not as sensitive to lower-quality links due to its link training and generation downgrade abilities, at higher link speeds, even through-hole vs SMD sockets can make a difference. So, if you want to go high-throughput, you want proper cabling and connectors, intended for out-of-chassis use  and OCuLink gives you all of this, at a low price.\n\nOCuLink is pretty unprecedented when it comes to officially supported hardware for pulling PCIe links externally. Theres Thunderbolt, sure, but it has to convert PCIe into packets on a Thunderbolt link, so you cant do a no-nonsense direct wireup and need proprietary tech, making you spend $100 or upwards on each end of the link. Your SoC likely doesnt have Thunderbolt support, and thats a good thing given just how much of a walled garden it still is.\nOCuLink can give you a 4x or 8x PCIe link using 4i and 8i options respectively, with cheap connectors, reliable cables, plus, a lively and growing ecosystem. It is also a good demonstration of what you need to pull PCIe outside of comfortable enclosures it typically inhabits, and, its a reasonably open standard for all it provides. Lets dig in!\nAccessible Mechanics\nFirst of all, what you want for such a standard is a well-defined pinout, a friendly connector, and abundance of connectors and cables in the real world. OCuLink hits all of these points, and, theres a trove of hardware on places like Aliexpress and Amazon. If you have an M.2 M-key socket with a 4x link free, you can easily pull it out of your device through an OCuLink cable  there are $20 M.2 cards with OCuLink sockets on them. The same goes for desktop PCIe slots  theres no shortage of cheap adapters.\nFrom the looks of it, you wouldnt want to crimp your own OCuLink cable  and you dont have to. Theres cables easily available online, too, in different lengths and link widths  SFF-8611 and SFF-8612 are good keywords for anything OCuLink. Theyre seriously cheap, you can get one for $10-$20. The cables are quite a bit more stiff than USB-C Thunderbolt-capable cables. Nevertheless, theyre easy to use, and there are even latching connectors in case you dont want sudden disconnect.\n\n\n\n\n\n\nOCuLink connectors look a bit like DisplayPort, and, theyre easy to find online. Just like USB-C, they have two sides, top and bottom, and the pin pitch makes it a requirement to do a two-row connector. You wont see a SMD + THT version like we often get with USB-C sockets, sadly  youll have to do pads under the package stenciling and reflow. That said, its well within the range of a standard hot air gun and a bit of paste, or maybe even just iron-tinned pads and some flux!\nSome Extra Circuitry\nThere are no power rails in the OCuLink pinout, which makes sense  that wouldve been an entire rabbit hole, given how varied PCIe devices can be. Youll want to take care of power separately, and the same might just be the case for the REFCLK clock pair  its not included in the standard pinout. Its possible to get REFCLK through OCuLink cables, and there are pinouts that use VSP pins for clock, so if your downstream device cant recover clock from PCIe data, thats what you might end up doing.\nIf you want to pull PCIe over a longer distance and make it more hotplug-friendly, you will also want a PCIe retimer. It will recondition your PCIe signal, helping it recover from any losses caused by the cable and the connectors involved. Often, a retimer will also provide some ESD protection as a bonus  if you want to do hotplug, remember that PCIe goes directly to a CPU/chipset/SoC as a rule and it usually has less strong ESD diodes, which makes it a pretty ESD-sensitive part of a system!\n\nTheres also documentation from PCI-SIG themselves that you might be able to find online if you want it; on the practical side, there are many community-aggregated resources. Plus, people are doing DIY OCuLink adapters more and more, and the pictured adapter is open-source, even! I hope that, whoever reads this, takes care to open-source their projects  reference designs are always useful and allow everyone to build increasingly cool things!\nEver Growing And Worth Knowing\nIn production, OCuLink has been used a lot in modern servers, where its not uncommon to want PCIe half a meter away from the chipset, wired up to something like a bay full of NVMe drives. As tech trickles down, its also gaining more adoption in laptop space! Currently, its being used by eGPU tinkerers, with people adding OCuLink sockets to devices like GPD mini laptops, or full laptops like the Lenovo Thinkbook, with the latter sporting a third-party adapter option that hijacks a Logitech receiver socket Lenovo added in.\nYou can still put PCIe over USB3, HDMI and USB-C cables  thats what we used to do before OCuLink! And, if you want a reference for how to do it right, taught by a modern-day ecosystem that does high-bandwidth connection without breaking a sweat, the list of OCuLink projects is only becoming larger  which is why you deserve knowing about it as an option.", "title": "OCuLink: \u5916\u4ed8\u3051\u306ePCIe\u30bd\u30ea\u30e5\u30fc\u30b7\u30e7\u30f3\u3092DIY\u3057\u3088\u3046\uff01", "body": "OCuLink\u306f\u5916\u90e8\u306ePCIe\u30ea\u30f3\u30af\u3092\u5f15\u3063\u5f35\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u308b\u6a19\u6e96\u3067\u3001eGPU\u30b9\u30da\u30fc\u30b9\u3067\u4eba\u6c17\u304c\u9ad8\u304f\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u4f4e\u4fa1\u683c\u3067\u4fe1\u983c\u6027\u306e\u3042\u308b\u30b1\u30fc\u30d6\u30eb\u3068\u30b3\u30cd\u30af\u30bf\u3092\u63d0\u4f9b\u3057\u30014\u500d\u901f\u307e\u305f\u306f8\u500d\u901f\u306ePCIe\u30ea\u30f3\u30af\u3092\u5b9f\u73fe\u3057\u307e\u3059\u3002OCuLink\u3092\u4f7f\u7528\u3059\u308b\u3068\u3001\u9ad8\u5e2f\u57df\u5e45\u306e\u63a5\u7d9a\u304c\u7c21\u5358\u306b\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u3001OCuLink\u30a2\u30c0\u30d7\u30bf\u3082DIY\u3067\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002\u305d\u306e\u4ed6\u306e\u5b9f\u7528\u7684\u306a\u60c5\u5831\u3084\u53c2\u8003\u8cc7\u6599\u3082\u5229\u7528\u3067\u304d\u307e\u3059\u3002", "titles": ["OCuLink: \u5916\u4ed8\u3051\u306ePCIe\u30bd\u30ea\u30e5\u30fc\u30b7\u30e7\u30f3\u3092DIY\u3057\u3088\u3046\uff01", "OCuLink: \u9ad8\u901f\u306a\u30c7\u30fc\u30bf\u8ee2\u9001\u3092\u5b9f\u73fe\u3059\u308b\u30d7\u30ed\u30c8\u30b3\u30eb\u306e\u7d39\u4ecb", "\u81ea\u4f5c\u6d3e\u5fc5\u898b\uff01OCuLink\u3067PCIe\u30ea\u30f3\u30af\u3092\u5916\u90e8\u306b\u5f15\u304f\u65b9\u6cd5\u3068\u306f\uff1f", "OCuLink: \u96fb\u5b50\u5de5\u4f5c\u306b\u304a\u3051\u308b\u5916\u90e8PCIe\u63a5\u7d9a\u306e\u305f\u3081\u306e\u6a19\u6e96\u4ed5\u69d8", "\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u30cf\u30c3\u30ab\u30fc\u306b\u30aa\u30b9\u30b9\u30e1\uff01\u5b89\u4fa1\u306aOCuLink\u30b3\u30cd\u30af\u30bf\u3068\u30b1\u30fc\u30d6\u30eb\u306e\u6d3b\u7528"]}