{"pubDate": "2024-12-27T15:00:56", "original_title": "This Week in Security: License Plates, TP-Link, and Attacking Devs", "link": "https://hackaday.com/2024/12/27/this-week-in-security-license-plates-tp-link-and-attacking-devs/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2016/01/darkarts.jpg", "original_content": "Were covering two weeks of news today, which is handy, because the week between Christmas and New Years is always a bit slow.\nAnd up first is the inevitable problem with digital license plates. Unless very carefully designed to be bulletproof, they can be jailbroken, and the displayed number can be changed. And the Reviver plates were definitely not bulletproof, exposing a physical programming port on the back of the plate. While its not explicitly stated, were guessing thats a JTAG port, given that the issue is considered unpatchable, and the port allows overwriting the firmware. That sort of attack can be hardened against with signed firmware, and using an MCU that enforces it.\nThis does invite comparisons to the James Bond revolving license plate  and that comparison does put the issue into context. Its always been possible to swap license plates. If someone really wants to cause mischief, traditional plates can be stolen, or even faked. What a digital plate adds to the equation is the ability to switch plate numbers on the fly, without stopping or turning a screwdriver. Regardless, this seems like it will be an ongoing problem, as so many manufacturers struggle to create secure hardware.\nMalicious RDP\nTheres a clever attack, that uses Microsofts Remote Desktop Protocol (RDP), to give away way too much control over a desktop. Thats accomplished by sending the target a .rdp file that shares local resources like the clipboard, filesystem, and more. Whats new is that it seems this theoretical attack has now shown up in the wild.\nThe attack campaign has been attributed to APT29, CozyBear, a threat actor believed to be associated with Russias Foreign Intelligence Service. This attribution tracks with the victims of choice, like government, research, and Ukrainian targets in particular. To escape detection, the malicious RDP endpoints are set up behind RDP proxies, running on services like AWS. The proxies and endpoints are accessed through TOR and other anonymous proxies. The .rdp files were spread via spear-phishing emails sent through compromised mail servers. The big push, with about 200 targets, was triggered on October 22nd. Researchers at TrendMicro believe this was the end of a targeted campaign. The idea being that at the end of the campaign, it no longer matters if the infrastructure and methods get discovered, so aim for maximum impact.\nFree* Mcdonalds?\nHere we learn that while McDonalds USA dosnt have a bug bounty program, McDonalds India does  and thats why researcher [Eaton Zveare] looked there. And found a series of Broken Object Level Authorization (BOLA) bugs. Thats a new term to this column, but a concept weve talked about before. BOLA vulnerabilities happen when a service validates a users authentication token, but doesnt properly check that the user is authorized to access the specific resources requested.\nIn the McDonalds case, any user of the web app is issued a guest JWT token, and that token is then valid to access any Order ID in the system. That allows some interesting fun, like leaving reviews on other users orders, accessing delivery maps, and getting copies of receipts. But things got really interesting when creating an account, and then ordering food. A hidden, incomplete password login page allowed breaking the normal user verification flow, and creating an account. Then after food is added to the cart, the cart can be updated to have a total price of a single rupee, about the value of a penny.\nThis research earned [Eaton] a $240 Amazon gift card, which seems a little stingy, but the intent behind the gesture is appreciated. The fixes landed just over 2 months after reported, and while [Eaton] notes that this is slower than some companies, its significantly faster than some of the less responsive vendors that weve seen.\nBanning TP-Link\nThe US Government has recently begun discussing a plan to ban TP-Link device purchases in the United States. The reported reason is that TP-Link devices have shipped with security problems. One notable example is a botnet that Microsoft has been tracking, that primarily consists of TP-Link devices.\nThis explanation rings rather hollow, particularly given the consistent security failings from multiple vendors that weve covered on this very column over the years. Where it begins to make more sense is when considered in light of the Chinese policy that all new vulnerabilities must first be reported to the Chinese government, and only then can fixes be rolled out. It suggests that the US Commerce Department suspects that TP-Link is still following this policy, even though its technically now a US company.\nIm no stranger to hacking TP-Link devices. Many years ago I wrote a simple attack to put the HTTPD daemon on TP-Link routers into debug mode, by setting the wifi network name. Because the name was used to build a command run with bash, it was possible to do command injection, build a script in the devices /tmp space, and then execute that script. Getting to debug mode allowed upgrading to OpenWRT on the device. And that just happens to be my advice for anyone still using TP-Link hardware: install OpenWRT on it.\nDevelopers Beware\nWe have two separate instances of malware campaigns directly targeting developers. The first is malicious VSCode extensions being uploaded to the marketplace. These fakes are really compelling, too, with lots of installs, reviews, and links back to the real pages. These packages seem to be droppers for malware payloads, and seem to be targeting cryptocurrency users.\nIf malware in your VSCode extensions isnt bad enough, OtterCookie is a campaign believed to come from North Korea, spreading via fake job interviews. The interview asks a candidate to run a Node.js project, or install an npm package as part of prep. Those are malicious packages, and data stealers are deployed upon launch. Stay frosty, even on the job hunt.\nBits and Bytes\nPHP has evolved over the years, but there are still a few quirks that might trip you up. One of the dangerous ones is tied up in $_SERVER['argv'], a quick way to test if PHP is being run from the command line, or on a server. Except, that relies on register_argc_argv set to off, otherwise query strings are enough to fool a naive application into thinking its running on the command line. And thats exactly the footgun that caught Craft CMS with CVE-2024-56145.\nAustralia may know something we dont, setting 2030 as the target for retiring cryptography primitives that arent quantum resistant. Thats RSA, Elliptic-curve, and even SHA-256. Its a bit impractical to think that those algorithms will be completely phased out by then, but its an interesting development to watch.\nFuzzing is a deep subject, and the discovery of 29 new vulnerabilities found in GStreamer is evidence that theres still plenty to discover. This wasnt coverage-guided fuzzing, where the fuzzer mutates the fuzzing input to maximize. Instead, this work uses a custom corpus generator, where the generator is aware of how valid MP4 files are structured.", "title": "\u30c7\u30b8\u30bf\u30eb\u30ca\u30f3\u30d0\u30fc\u30d7\u30ec\u30fc\u30c8\u306e\u8106\u5f31\u6027\u3068\u30cf\u30c3\u30ad\u30f3\u30b0\u306e\u30ea\u30b9\u30af", "body": "\u30c7\u30b8\u30bf\u30eb\u30ca\u30f3\u30d0\u30fc\u30d7\u30ec\u30fc\u30c8\u306e\u8106\u5f31\u6027\u3084\u30de\u30eb\u30a6\u30a7\u30a2\u653b\u6483\u306a\u3069\u3001\u6700\u65b0\u30cb\u30e5\u30fc\u30b9\u304c\u5831\u544a\u3055\u308c\u305f\u3002", "titles": ["\u30c7\u30b8\u30bf\u30eb\u30ca\u30f3\u30d0\u30fc\u30d7\u30ec\u30fc\u30c8\u306e\u8106\u5f31\u6027\u3068\u30cf\u30c3\u30ad\u30f3\u30b0\u306e\u30ea\u30b9\u30af", "Microsoft RDP\u3092\u5229\u7528\u3057\u305f\u65b0\u305f\u306a\u30de\u30eb\u30a6\u30a7\u30a2\u653b\u6483", "\u30de\u30af\u30c9\u30ca\u30eb\u30c9\u306eBOLA\u30d0\u30b0\u306b\u3088\u308b\u30aa\u30f3\u30e9\u30a4\u30f3\u6ce8\u6587\u306e\u8106\u5f31\u6027\u3068\u306f", "\u7c73\u653f\u5e9c\u306b\u3088\u308bTP-Link\u88fd\u54c1\u306e\u8cfc\u5165\u7981\u6b62\u8a08\u753b", "\u958b\u767a\u8005\u5fc5\u898b\uff01VSCode\u62e1\u5f35\u6a5f\u80fd\u3092\u72d9\u3063\u305f\u30de\u30eb\u30a6\u30a7\u30a2\u30ad\u30e3\u30f3\u30da\u30fc\u30f3"]}