{"pubDate": "2023-06-02T14:00:33", "original_title": "This Week in Security: Barracuda, Zyxel, and The Backdoor", "link": "https://hackaday.com/2023/06/02/this-week-in-security-barracuda-zyxel-and-the-backdoor/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2016/01/darkarts.jpg", "original_content": "Barracudas Email Security Gateway (ESG) has had a vulnerability in it for years. Tracked as CVE-2023-2868, this one was introduced back in version 5.1.3.001, and only got patched during the 9.2 development cycle. Specific build information on patched firmware has not been made available, but a firmware build containing the patch was deployed on May 20.\nThe flaw was a command injection bug triggered by .tar files attached to incoming emails. The appliance scans attachments automatically, and the file names could trigger the qx operator in a Perl script. Its a nasty one, ranking a 9.4 on the CVSS scale. But the really bad news is that Barracuda found the vulnerability in the wild, and they have found evidence of exploitation as far back as October 2022.\nThere have been three malware modules identified on the compromised appliances. SALTWATER is a backdoor trojan, with the ability to transfer files, execute commands, and host network tunnels. SEASPY is a stealthier module, that looks like a legitimate service, and uses PCAP to monitor traffic and receive commands. And SEASIDE is a Lua module for the Barracuda SMTP monitor, and it exists to host a reverse shell on command. Indicators of Compromise (IOCs) have been published, and Barracuda recommends the unplug-and-remove approach to cleaning up an infection. The saving grace is that this campaign seems to have been targeted, and wasnt launched against every ESG on the Internet, so maybe youre OK.\nMoxa, Too\nAnd speaking of security software that has problems, the Moxa MXsecurity appliance has a pair of problems that could be leveraged together to lead to a complete device takeover. The most serious problem is a hard coded credential, that allows authentication bypass for the web-API. Then the second issue is a command-line escape, where an attacker with access to the devices Command Line Interface (CLI) can break out and run arbitrary commands.\nAnd Zyxel\nAnd while weve talked about this one before, if you have an unpatched Zyxel Firewall on the internet, you should just assume that its been compromised. Its a command injection flaw that was patched in late April, and allowed a single malicious UDP packet to compromise the machine. In the month since then, this vulnerability has been added to the Mirai botnet, and it looks like quite a few have fallen. And if you patched the previous problems, dont rest, as there have been another pair of CVSS 9.8 severity flaws.\nGigabytes Backdoor\nBut who needs malware when you have OEMs like these? One of the scary scenarios is a machines firmware getting compromised, and that firmware dropping files into your system on boot. Far-fetched? Apparently thats exactly what the official Gigabyte firmware does to launch the Gigabyte APP Center.\nA multi-step process, starting in the boards firmware, writes a Windows executable to disk and sets registries values to launch the executable as a service. That service downloads and executes an update from from Gigabyte, potentially loaded over an unencrypted HTTP connection. And the encrypted connection? Accepts a self-signed certificate. It looks like this functionality allows anyone that can pull off a Man-in-the-Middle (MitM) attack to run arbitrary code on the machine. Not to mention the possibility of compromising Gigabytes update server, and loading malware on a bunch of machines at once. The only saving grace is that this firmware function is disabled by default on most machines, but Eclypsium did discover the issue by finding it enabled in the wild, so some percentage of machines have it enabled.\nThis is obviously really bad. Gigabyte is working to get this updated, but a problem like this one will have quite the tail, given how rarely most of us install motherboard updates. The good news is that there havent been any attacks found in the wild. The bad news is that the details have all been released, so watch out for someone to try to take advantage of it.\nAndroid App Gone Bad\nThe iRecorder app on Android was added to the Play Store mid 2021, and pretty much did exactly what it claimed  record the screen. Nearly a year later, the app was updated to 1.3.8, and added some less-wholesome capabilities. It suddenly could record audio, and upload it and other files to a Command and Control (CC) server. The app was reported and yanked from the store, but its unclear who is responsible for the campaign. Its surprising that a malicious app designer would wait that long to weaponize an app, which raises the suggestion that this could have been a supply chain attack. Someone could have hacked the developer, and pushed malicious code surreptitiously.\nBits and Bytes\nWireshark has a new release, and this one actually fixes some important security problems. We dont think about it much since wireshark uses PCAP to capture packets, rather than receive them directly, but this software has a bunch of data parsers built in to it. And just like any other software, it only takes a simple mistake for something malicious to break the code behind a parser.\nNextcloud has a fun set of fresh vulnerabilities. A couple of them are relatively high severity, but the most amusing is a problem with logging out. Turns out that not all of the users local session data was neutralized when hitting the logout button, and so the next user to authenticate would be logged in as the previous account. Whoops.\nAnd Libreoffice has had an update fixing two notable issues. The first is a floating frame feature, which displays content from a linked document. That frame was loading content without prompting the user, leading to some potential security mitigation bypasses. And the second, more serious problem, is an array index underflow when parsing a malformed spreadsheet formula. There isnt a Proof of Concept released for this one, but the LibreOffice folks believe that arbitrary code execution is possible as a result. So go forth and update!", "title": "\u96fb\u5b50\u30e1\u30fc\u30eb\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306b\u8106\u5f31\u6027\u3001Barracudas ESG\u3067\u6df1\u523b\u306a\u554f\u984c\u767a\u751f", "body": "\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30bd\u30d5\u30c8\u306b\u554f\u984c\u3001Barracuda Email Security Gateway\u306f\u9577\u5e74\u306e\u8106\u5f31\u6027\u3001Moxa MXsecurity\u306f\u4e8c\u91cd\u306e\u554f\u984c\u3001Zyxel Firewall\u3082\u554f\u984c\u3002\u30d5\u30a1\u30fc\u30e0\u30a6\u30a7\u30a2\u306b\u7d1b\u308c\u8fbc\u3093\u3067\u304d\u305f\u60aa\u610f\u3042\u308b\u30d5\u30a1\u30a4\u30eb\uff08Gigabytes APP Center\uff09\u306b\u6ce8\u610f\u3002iRecorder\u30a2\u30d7\u30ea\u304c\u30b5\u30d7\u30e9\u30a4\u30c1\u30a7\u30fc\u30f3\u653b\u6483\u306e\u53ef\u80fd\u6027\u304c\u3042\u308b\u3002Wireshark\u3001Nextcloud\u3001Libreoffice\u3082\u554f\u984c\u304c\u660e\u3089\u304b\u306b\u3002", "titles": ["\u96fb\u5b50\u30e1\u30fc\u30eb\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306b\u8106\u5f31\u6027\u3001Barracudas ESG\u3067\u6df1\u523b\u306a\u554f\u984c\u767a\u751f", "MX\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u306b\u554f\u984c\u3001\u5b8c\u5168\u306a\u30c7\u30d0\u30a4\u30b9\u4e57\u3063\u53d6\u308a\u304c\u53ef\u80fd\u306b", "\u30b6\u30a4\u30bb\u30eb\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u306b\u672a\u89e3\u6c7a\u306e\u8106\u5f31\u6027\u3001Mirai\u30dc\u30c3\u30c8\u30cd\u30c3\u30c8\u306b\u8ffd\u52a0\u3055\u308c\u305f\u554f\u984c", "Gigabytes\u6a5f\u5668\u306e\u30d5\u30a1\u30fc\u30e0\u30a6\u30a7\u30a2\u306b\u554f\u984c\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u30de\u30b7\u30f3\u306b\u4fb5\u5165\u3059\u308b\u6050\u308c", "Android\u30a2\u30d7\u30ea\u304c\u60aa\u610f\u3092\u6301\u3063\u3066\u66f4\u65b0\u3055\u308c\u3001\u30b9\u30af\u30ea\u30fc\u30f3\u306e\u9332\u753b\u3068\u30aa\u30fc\u30c7\u30a3\u30aa\u8a18\u9332\u304c\u884c\u308f\u308c\u308b"]}