{"pubDate": "2023-12-14T18:00:27", "original_title": "Hacker Tactic: Internal ESD Diode Probing", "link": "https://hackaday.com/2023/12/14/hacker-tactic-internal-esd-diode-probing/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2023/11/hadimg_esd_poking_feat.jpg", "original_content": "Humans are walking high voltage generators, due to all the friction with our surroundings, wide variety of synthetic clothes, and the overall everpresent static charges. Our electronics are sensitive to ESD, and often theyre sensitive in a way most infuriating  causing spurious errors and lockups. Is there a wacky error in your design that will repeat in the next batch, or did you just accidentally zap a GPIO? You wouldnt known until you meticulously check the design, or maybe its possible for you to grab another board.\nThankfully, in modern-day Western climates and with modern tech, you are not likely to encounter ESD-caused problems, but they were way more prominent back in the day. For instance, older hackers will have stories of how FETs were more sensitive, and touching the gate pin mindlessly could kill the FET youre working with. Now, weve fixed this problem, in large part because we have added ESD-protective diodes inside the active components most affected.\nThese diodes dont just help against ESD  theyre a general safety measure for protecting IC and transistor pins, and they also might help avoid damaging IC pins if you mix. They also might lead to funny and unexpected results  for instance, parts of your circuit powering when you dont expect them to! However, theres an awesome thing that not that many hackers  they let you debug and repair your circuits in a way you might not have imagined.\n\nDebugging Wiring And Chips Alike\nHeres a simple scenario. You have a button connected to your Arduino, with some long wires, maybe its even on a screwy breadboard. One pin is connected to ground, and another is connected to a GPIO. You press this button, and nothing happens in your code. Why is that?\nFirst, you want to verify your connections, and, Arduino-internal ESD diodes let you do that with a single measurement at the button. Put your multimeter into diode test mode (or low-resistance measurement mode), then reverse your multimeter leads, putting the red lead on ground and black lead on the button pin. Then, touch the button pins and see if you can sense an internal diode  if not, your wiring is likely suspect.\nThis is not all, however. Do you have a broken PCIe GPU? It can be overwhelming  many things could be broken, where do you start? It could be the GPU chip itself, it could be one of the smaller memory chips, or it could be the VRM. An ESD diode test helps yet again. Put the red lead on GND, and check the card edge pins with PCIe diffpairs, probing behind series capacitors where those are present near the card edge.\nThe results are stunning  you can notice a GPU core chip failure that you wouldnt normally. Its simple  card edge-connected GPIOs will have a certain kind of voltage drop, and the PCIe link will also have a certain voltage drop, just a different one, because high-speed links need different ESD diode structures.\nIf one or few PCIe pins or GPIOs deviate from the PCIe or GPIO ESD diode value on all other pins, you might just have a broken core  this knowledge will save you a hefty amount of time if you are thinking of reballing the GPU or fixing some other areas like the VRM. Its a super efficient way to test your tech, and of course, it works for other things like ICs.\nTheres more  you are probing a board, and you want to know where a resistor goes. Is it a pulldown resistor, is it connected to some external connector, or is it part of some analog circuit? With red lead on ground again, check if theres a diode  thats how you can know its connected to a digital input of some sort, or floating.\nPowerful, Simple, Friendly\nWould you believe me if I told you theres more? If youve ever browsed Aliexpress for devboards or PC tech, you have likely seen these adapters with tons of LEDs and a battery board. These are tester boards for PC components, they are beautifully analog in how they operate, and its insanely easy to build your own  let me show you how.\nYep, these testers also test the presence of ESD diodes. Furthermore, the LED will shine with different brightness depending on the nature of the connection. Its seriously awesome in how quickly you can test things at a fundamental level with these boards. If your desktops CPU doesnt boot, it might just be a broken ball in its LGA socket, and plugging such a tester in will save you a metric kiloton of trouble debugging other things.\nThey are dead simple, too. If you want to test 20 or 200 connections at once, you only need a CR2032 battery and a bunch of LEDs  maybe some series resistors, but even those dont seem necessary to me. The coin cell batteries have an internal resistance of their own, which helps us because we dont need per-LED current limiting resistors  you can just shower a board in LEDs, add a coin cell holder, and make it into a debugger for anything.\n\nAs a USB-C zealot, of course, Ive made a USB-C tester  and immediately tested it on some of my broken or mysterious USB-C ports, to great success. Here are the Kicad files, complete with a very broken-looking schematic.\nFor a start, this lets you check if any USB-C port youre working with, is USB2-enabled or not. Is that docking station port charger-only, or can you also plug a flashdrive in? The default answer is charger-only, but here, you can check for sure. However, it doesnt end here  such a tester will give you an analog-ish value the same way that a multimeter test would!\nAn unhealthy USB-C port. Replacing the PD controller fixed it\nThe LED brightness will vary depending on whats connected to the pin. For instance, is this CC pin connected to an IC digital pin, is it a dead short to GND, does it just go to a pulldown resistor, or is it disconnected? This tester will show you all through LED brightness alone. Its hard to see on the pictures, but your eye will be able to distinguish between different pins and their roles, and theres something deeply beautiful about it.\nIs your USB-C port mechanically screwy, perhaps? Or is it just that a CC pin on it is shorted, and thats why it only works in one orientation? Maybe one of the USB3 data pairs is broken because a capacitor flew off? Ive already managed to debug all of these cases, using this board to fix a few dead USB-C ports.\nWhy So Unpopular?\nBy now, Im seriously confused why we never saw such a tester for, say, MicroUSB ports. How come? Itd be super easy to have LEDs for VBUS, D+, D- and ID, with the ID pin LED telling you immediately whether the MicroUSB port on your smartphone is capable of OTG mode, and itd cost about $1. Theres no shortage of RAM and CPU testers on Eastern platforms, and repair shops have long adopted them, but the hacker world is missing out on some tiny fun peripherals that are within the reach of our fingertips.\nIn short, internal ESD diode testing is a severely underappreciated hacker tactic. Whatever you want to do, whether its PC component repair, or checking cables, or testing your boards for shorts after reflow, probing for ESD diodes is easy, and can give you insights at the speed of light."}