{"pubDate": "2023-05-05T14:00:39", "original_title": "This Week in Security: Oracle Opera, Passkeys, and AirTag RFC", "link": "https://hackaday.com/2023/05/05/this-week-in-security-oracle-opera-passkeys-and-airtag-rfc/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2016/01/darkarts.jpg", "original_content": "Theres a problem with Opera. No, not that kind of opera. The Oracle kind. Oracle OPERA is a Property Management Solution (PMS) that is in use in a bunch of big-name hotels around the world. The PMS is the system that handles reservations and check-ins, talks to the phone system to put room extensions in the proper state, and generally runs the back-end of the property. Its old code, and handles a bunch of tasks. And researchers at Assetnote found a serious vulnerability. CVE-2023-21932 is an arbitrary file upload issue, and rates at least a 7.2 CVSS.\nIts a tricky one, where the code does all the right things, but gets the steps out of order. Two parameters, jndiname and username are encrypted for transport, and the sanitization step happens before decryption. The username parameter receives no further sanitization, and is vulnerable to path traversal injection. There are two restrictions to exploitation. The string encryption has to be valid, and the request has to include a valid Java Naming and Directory Interface (JNDI) name. It looks like these are the issues leading Oracle to consider this flaw \u201cdifficult to exploit vulnerability allows high privileged attacker\u2026\u201d.\nThe only problem is that the encryption key is global and static. It was pretty straightforward to reverse engineer the encryption routine. And JDNI strings can be fetched anonymously from a trio of endpoints. This lead Assetnote to conclude that Oracles understanding of the flaw is faulty, and a much higher CVSS score is appropriate. Particularly with this Proof of Concept code, it is relatively straightforward to upload a web shell to an Opera system.\nThe one caveat there is that an attacker has to get network access to that install. These arent systems intended to be exposed to the internet, and my experience is that they are always on a dedicated network connection, not connected to the rest of the office network. Even the interconnect between the PMS and phone system is done via a serial connection, making this network flaw particularly hard to get to.\nPasskeys Are Here\nIn case you missed the hype, passwords are dead, apparently. The replacement is the Passkey, a public/private keypair that is managed by the security processor on the users device. Whats new this week is yet another big service rolling out support for Passkeys for everyone. Google in this case, now offers Passkey logins for all personal Google accounts.\nFor all the hype, its worth pointing out that passkeys are just passwords, with all the best-practice options mandated. Its a string of data that isnt based on dictionary words, is stored securely by a credential manager, is never re-used across sites, never expires, and is only used in secure cryptographic proofs. Oh, and Chrome on MacOS and on some Windows 10 and 11 installs can handle passkeys. But sadly theres no love for Linux users yet.\nLocation Tracker RFC\nApples AirTags have found some unexpected uses by clever folks. From tracking mail routes to recovering stolen scooters. But unfortunately, theres been some less-than-ethical uses, too. Stalking is a crime, and its a bad look for Apples gadgets to trivially enable it. So, engineers from Apple and Google put their heads together, and came up with an RFC on detecting unwanted location trackers.\nThe basic requirements of the RFC are that trackers use Bluetooth Low Energy (BLE) to communicate, and support talking to non-owners over BLE. This connection allows a non-owner to identify when a device is following along. The device needs to have some way to make noise, so the trackee can physically locate the device, and most importantly, have a built-in method to disable the tracker. Essentially, there has to be a button to turn the tracking off. It seems like this will effectively prevent the use of AirTags as a malicious tracker. Unfortunately, it also seems like it will put an end to the biggest legitimate use of AirTags  theft prevention. Its really not obvious how to prevent digital stalking, and still enable the tracking of stolen physical goods.\nCloud Smishing\nThis particular story is full of surprises, like discovering that Amazon AWS has a text message service, Amazon Simple Notification Service (SNS). And furthermore, text-based phishing is common enough, it has a fancy, dedicated name: Smishing. And the last realization is that its one more thing to abuse when an attacker manages to access an AWS account.\nThe theory is that legitimate users may have already been getting text messages from the service, so sending a smishing message through the same service might be more likely to succeed. So now we know, theres one more thing to watch out for.\nBits and Bytes\nSo youre doing a network capture, have a data stream in the clear, and capture a binary blob going over the wire. What is it? An encrypted file? Something Protobuf encoded? [Ron] at SkullSecurity had exactly this situation, and after trying multiple dead-ends, he finally turned to the humble file command. Thats an ancient Unix command, that reads the magic bytes at the beginning of a file and attempts to determine the file type. It worked with the mystery stream, too. Turns out it was zlib compressed data. Neat!\nEver wondered what exactly those various malicious NPM packages do? [Gaby Dobocan] at Sandworm has us covered, reviewing 5 malicious NPM packages going all the way back to 2018. Some packages just run a remote script, while others leaked environment variables inside a remote HTTP request. The most fun is alicov, which finishes running remote code, and then informs the user that theyve been had.\nIts another week, and so we have another trio of exploited flaws on CISA. This time its a pre-auth Remote Code Execution problem in TP-Links Archer AX21 routers. Oracles WebLogic patched a RCE problem in January, and while that one just made the list, it seems to already be back off the radar of active exploitation. The last one is another problem in Log4j, a sister-vulnerability to the notorious Log4Shell issue. It seems to be less widespread, but is also an RCE. And thats it for this week. Stay safe cruising the hyperwebs!", "title": "\u30aa\u30e9\u30af\u30eb\u306ePMS\u30b7\u30b9\u30c6\u30e0\u306b\u6df1\u523b\u306a\u8106\u5f31\u6027\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u63a5\u7d9a\u306b\u3088\u308b\u653b\u6483\u304c\u61f8\u5ff5\u3055\u308c\u308b", "body": "\u30db\u30c6\u30eb\u4e88\u7d04\u30b7\u30b9\u30c6\u30e0\u300cOracle OPERA\u300d\u306b\u91cd\u5927\u306a\u8106\u5f31\u6027\u304c\u898b\u3064\u304b\u308a\u307e\u3057\u305f\u3002\u307e\u305f\u3001\u30d1\u30b9\u30ad\u30fc\u3084AirTags\u306e\u8ffd\u8de1\u65b9\u6cd5\u3082\u5831\u544a\u3055\u308c\u3001AWS\u306e\u30c6\u30ad\u30b9\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u6a5f\u80fd\u3082\u4e57\u3063\u53d6\u308a\u306e\u30bf\u30fc\u30b2\u30c3\u30c8\u306b\u306a\u3063\u305f\u4e8b\u304c\u5831\u544a\u3055\u308c\u307e\u3057\u305f\u3002", "titles": ["\u30aa\u30e9\u30af\u30eb\u306ePMS\u30b7\u30b9\u30c6\u30e0\u306b\u6df1\u523b\u306a\u8106\u5f31\u6027\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u63a5\u7d9a\u306b\u3088\u308b\u653b\u6483\u304c\u61f8\u5ff5\u3055\u308c\u308b", "Google\u304c\u30d1\u30b9\u30ad\u30fc\u5bfe\u5fdc\u3092\u958b\u59cb\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u4ee3\u66ff\u3068\u3057\u3066", "Apple\u3068Google\u304c\u300c\u4e0d\u6b63\u306a\u4f4d\u7f6e\u60c5\u5831\u8ffd\u8de1\u300d\u5bfe\u7b56\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u63d0\u4f9b", "Amazon\u306eSNS\u304cSmishing\u653b\u6483\u306e\u5de3\u7a9f\u306b\u3001\u6b63\u898f\u30e1\u30c3\u30bb\u30fc\u30b8\u3068\u540c\u3058\u30ea\u30b9\u30af\u304c\u3042\u308b", "SkullSecurity\u304c\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30ad\u30e3\u30d7\u30c1\u30e3\u30fc\u3057\u305f\u30c7\u30fc\u30bf\u306e\u89e3\u6790\u65b9\u6cd5\u3092\u7d39\u4ecb\u3001zlib\u5727\u7e2e\u30c7\u30fc\u30bf\u3060\u3063\u305f\u3053\u3068\u304c\u5224\u660e"]}