{"pubDate": "2024-06-14T14:00:50", "original_title": "This Week in Security: Unicode Strikes Again, Trust No One (Redditor), and More", "link": "https://hackaday.com/2024/06/14/this-week-in-security-unicode-strikes-again-trust-no-one-redditor-and-more/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2016/01/darkarts.jpg", "original_content": "Theres a popular Sysadmin meme that system problems are always DNS. In the realm of security, it seems like its always Unicode. And its not hard to see why. Unicode is the attempt to represent all of Earths languages with a single character set, and that means theres a lot of very similar characters. The two broad issues are that human users cant always see the difference between similar characters, and that libraries and applications sometimes automatically convert exotic Unicode characters into more traditional text.\nThis week we see the resurrection of an ancient vulnerability in PHP-CGI, that allows injecting command line switches when a web server launches an instance of PHP-CGI. The solution was to block some characters in specific places in query strings, like a query string starting with a dash.\nThe bypass is due to a Windows feature, Best-Fit, an automatic down-convert from certain Unicode characters. This feature works on a per-locale basis, which means that not every system language behaves the same. The exact bypass that has been found is the conversion of a soft hyphen, which doesnt get blocked by PHP, into a regular hyphen, which can trigger the command injection. This quirk only happens when the Windows locale is set to Chinese or Japanese. Combined with the relative rarity of running PHP-CGI, and PHP on Windows, this is a pretty narrow problem. The XAMPP install does use this arrangement, so those installs are vulnerable, again if the locale is set to one of these specific languages. The other thing to keep in mind is that the Unicode character set is huge, and its very likely that there are other special characters in other locales that behave similarly.\nDownloader Beware\nThe ComfyUI project is a flowchart interface for doing AI image generation workflows. Its an easy way to build complicated generation pipelines, and the community has stepped up to build custom plugins and nodes for generation. The thing is, its not always the best idea to download and run code from strangers on the Internet, as a group of ComfyUI users found out the hard way this week. The ComfyUI_LLMVISION node from u/AppleBotzz was malicious.\nThe node references a malicious Python package that grabs browser data and sends it all to a Discord or Pastebin. It appears that some additional malware gets installed, for continuing access to infected systems. Its a rough way to learn.\nPyTorch Scores a Dubious 10.0\nCVE-2024-5480 is a PyTorch flaw that allows PyTorch worker nodes to trigger arbitrary eval() calls on the master node. No authentication is required to add a PyTorch worker, so this is technically an unauthorized RCE, earning the CVSS of 10.0. Practically speaking its not that dire of a problem, as your PyTorch cluster shouldnt be on the Internet to start with, and theres no authentication as a design choice. Its not clear the the PyTorch developers consider this a legitimate security vulnerability at all. It may or may not be fixed with version 2.3.\nNext Level Smishing\nMy least favorite term in infosec has to be smishing, a frankenword for SMS phishing. Cell phone carriers around the world are working hard to blocking spam messages, making smishing an impossible task. And thats why its particularly interesting to hear about a bypass that a pair of criminals were using in London. The technical details are light, but the police reported a homemade mobile antenna, illegitimate telephone mast, and text message blaster as part of the seized kit. The initial report sounds like it may be a sort of reverse stingray, where messages are skipping the regular cellular infrastructure and are getting sent directly to nearby cell phones. Hopefully more information will be forthcoming soon.\nZyxels NsaRescueAngel\nThe programmers at Zyxel apparently have a sense of humor, given the naming used for this mis-feature. Zyxel NAS units have a bit of magic code that writes a password for the new user, NsaRescueAngel, to the shadow password file. The SSH daemon is restarted, and upnp is fired off to request port forwarding from the outside world. One of the script names, possibly from a previous iteration, was open_back_door.sh, which seems to be sort of lampshading the whole thing.\nIts presumably intended to be a great troubleshooting tool, when a customer is stuck and needs help, to be able to visit a web url to enable remote access for a Zyxel tech. The problem is that the Zyxel NAS already has an authentication bypass flaw, and while its been patched, it wasnt patched very well, making this whole scheme accessible without authentication, just by slapping /favicon.ico onto the url. The additional problems have been fixed in a more recent update.\nRussian Secure Phablet?\nA Twitter thread tells the story of a Russian secure device, left behind on the back of a bus in England. Thats an interesting premise. But the thread continues, that conveniently the owner also left a briefcase with design notes, architecture, documentation, implementation, marketing material and internal Zoom demos about trusted devices too! OK, now this has to either be a fanfic, or a fell-off-the-back-of-a-truck story. Theres some convincing looking screenshots, and even rom dumps. Whats going on here?\n\nNobody knew how the devices worked, conveniently the owner also left a briefcase with design notes, architecture, documentation, implementation, marketing material and internal Zoom demos about trusted devices too! We'd all have been lost without those. https://t.co/LN7cTybxOV pic.twitter.com/j5OCHprSie\n hackerfantastic.x (@hackerfantastic) June 11, 2024\n\nThe most likely explanation is that somebody got their hands on a trove of data on these devices, and wanted to dump it online with a silly story. But fair warning, dont trust any of the shared files. Who knows whats actually in there. Taking a look at something untrusted like this is an art in itself, best done with isolated VMs and burner machines, maybe a Linux install you dont mind wiping?\nBits and Bytes\nBuskill just published their 8th warrant canary, a cryptographically signed statement attesting that they have not been served any secret warrants or national security letters that would undermine the trustworthiness of the Buskill project or code. In addition to a good cryptographic signature, this canary includes a handful of latest news headlines in the signed material, proving it is actually a recently generated document.\n[Aethlios] has published Reset Tolkien, an open source tool for finding and attacking a very specific sort of weakness in time based tokens. The targeted flaw is a token generated from improper randomness source, like the current time. If the pattern can be found, a sandwich attack can narrow down the possible reset codes by requesting a reset code for a controlled account, requesting one for the target account, and then once again for the controlled account. The target code must come between the two known codes.\nAnd finally, TPM security is hard. This time, the Trusted Platform Module can be reset by reclaiming the GPIO pins connected to it, and simulating a reboot by pulling the reset pin. This results in the TPM possibly talking to an application when it thinks it is talking to the CPU doing boot decryption. In short, it can result in compromised keys. Thanks to [char] from Discord for sending this one in!", "title": "Unicode\u306e\u8106\u5f31\u6027\uff1aPHP-CGI\u3067\u306e\u30b3\u30de\u30f3\u30c9\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u306b\u3064\u3044\u3066", "body": "\u30b7\u30b9\u30c6\u30e0\u554f\u984c\u304c\u5e38\u306bDNS\u3067\u3042\u308b\u3068\u3044\u3046Sysadmin\u306e\u30df\u30fc\u30e0\u304c\u3042\u308b\u4e00\u65b9\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u5206\u91ce\u3067\u306f\u5e38\u306bUnicode\u3067\u3042\u308b\u3088\u3046\u3067\u3059\u3002Unicode\u306f\u5730\u7403\u306e\u3059\u3079\u3066\u306e\u8a00\u8a9e\u30921\u3064\u306e\u6587\u5b57\u30bb\u30c3\u30c8\u3067\u8868\u73fe\u3057\u3088\u3046\u3068\u3059\u308b\u8a66\u307f\u3067\u3001\u975e\u5e38\u306b\u985e\u4f3c\u3057\u305f\u6587\u5b57\u304c\u591a\u3044\u305f\u3081\u3001\u30e6\u30fc\u30b6\u30fc\u304c\u4f3c\u305f\u6587\u5b57\u3092\u533a\u5225\u3067\u304d\u306a\u3044\u3053\u3068\u3084\u30e9\u30a4\u30d6\u30e9\u30ea\u3084\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u7570\u56fd\u306eUnicode\u6587\u5b57\u3092\u3088\u308a\u4f1d\u7d71\u7684\u306a\u30c6\u30ad\u30b9\u30c8\u306b\u81ea\u52d5\u5909\u63db\u3057\u3066\u3057\u307e\u3046\u3068\u3044\u3063\u305f\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002", "titles": ["Unicode\u306e\u8106\u5f31\u6027\uff1aPHP-CGI\u3067\u306e\u30b3\u30de\u30f3\u30c9\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u306b\u3064\u3044\u3066", "\u4e0d\u6b63\u306aPyTorch\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u306b\u3088\u308b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8106\u5f31\u6027", "\u30ed\u30f3\u30c9\u30f3\u306e\u72af\u7f6a\u8005\u306b\u3088\u308bSMS\u30d5\u30a3\u30c3\u30b7\u30f3\u30b0\u624b\u6cd5", "Zyxel NAS\u306e\u8a8d\u8a3c\u30d0\u30a4\u30d1\u30b9\u8106\u5f31\u6027\u3068\u300cNsaRescueAngel\u300d", "\u30ed\u30b7\u30a2\u88fd\u5b89\u5168\u643a\u5e2f\uff1a\u30d0\u30b9\u3067\u898b\u3064\u304b\u3063\u305f\u8b0e\u306e\u30c7\u30d0\u30a4\u30b9"]}