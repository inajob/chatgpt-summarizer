{"pubDate": "2023-09-15T14:00:56", "original_title": "This Week in Security: Blastpass, MGM Heist, and Killer Themes", "link": "https://hackaday.com/2023/09/15/this-week-in-security-blastpass-mgm-heist-and-killer-themes/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2016/01/darkarts.jpg", "original_content": "Theres yet another 0-day exploit chain discovered as part of NSO Groups Pegasus malware suite. This one is known as BLASTPASS, and its a nasty one. Theres no user interaction required, just receiving an iMessage containing a malicious PassKit attachment.\nWe have two CVEs issued so far. CVE-2023-41064 is a classic buffer overflow in ImageIO, the Apple framework for universal file format read and write. Then CVE-2023-41061 is a problem in the iOS Wallet implementation. Release 16.6.1 of the mobile OS addresses these issues, and updates have rolled out for macOS 11, 12, and 13.\nIts worth noting that Apples Lockdown mode does seem to block this particular exploit chain. Citizen Lab suggests that high-risk users of Apple hardware enable Lockdown Mode for that extra measure of security.\nMGM and Scattered Spider\nStarting the morning of September 11, MGM Resorts began experiencing systems outages as a result of a cybersecurity issue. Apparently it also hits their slot machines and ATMs  try to imagine a worse fate for the Las Vegas casino and hotel chain.\n\npic.twitter.com/nxIweGInsB\n MGM Resorts (@MGMResortsIntl) September 11, 2023\n\nIt turns out, this was the work of Scattered Spider, a group known to use social engineering to crack large networks, and then demand ransom payments to stand down. Its beginning to look like the initial attack vector here was a simple phone call to the helpdesk, asking for help getting logged in.\nChinas CVE Registry\nIve mused a few times that some companies must have arrangements with their national governments, to turn over vulnerabilities when discovered, and then slow-roll public announcement and fixes. Strictly speaking, thats a conspiracy theory, but it appears to be the state of play for the Chinese National Vulnerability Database. A 2021 law seems to mandate exactly this, giving companies doing business in China a two day deadline to hand over vulnerabilities.\nOn the other hand, as several companies point out, its not uncommon for governments to have regulations requiring vulnerabilities be reported to a government prior to disclosure. The full report maps out the Chinese government interaction with both discovered vulnerabilities and state-sponsored hacking, and makes a rather compelling case that there is overlap.\niOS Bluetooth Annoyance\nThere was an annoyance at DEF CON this year  Bluetooth popups on Apple phones. The trick here is to spoof Bluetooth Low Energy proximity actions. This is generally intended to allow pairing devices or sharing contact info, by bringing devices right to next to each other. To determine proximity, the device just uses signal strength, and thats the gimmic. Just push your broadcast power a little higher than a normal BLE device, and it shows up as being close enough to trigger a proximity action.\nWalk around DEF CON with the battery powered setup, and annoy all your new geeky friends! And if you dont want to build the rig out of a Raspberry Pi, apparently a Flipper Zero can pull off the same trick. Groovy.\nWill the Real 345gs5662d34 Please Stand Up?\nSo this is a bit of a mystery. Honeypots, open SSH services, and all sorts of other services are constantly being bombarded with login attempts. Some clever folks record those attempts, and track some of the data, like the most commonly attempted username and password. And the top five you might be able to guess: root, admin, user, test, and ubuntu. But the sixth most common username is an oddball: 345gs5662d34. And whats more, all the attempts to guess that username used the same string as the password. And a very similar 3245gs5662d34 shows up often as a password guess for other usernames.\nThe community has already come up with some plausible explanations, like the values being used as breadcrumbs to track a bot or do honeypot detection. The more interesting guess is that this is how a default username and password combination gets translated into ASCII text when typed on a non-English keyboard. Thats apparently already been observed with the similar string, ji32k7au4a83. If you have any guesses or answers to this mystery, let us know!\nKiller Themes\nThemebleed has it all. Its a silly, catchy name, illustrates TOCTOU, MotW, and SMB manipulation, and isnt actually all that serious. Its perfect. Loading a .theme file in Windows 10 should load a new system theme, merely changing the desktops appearance. Running a theme file downloaded from the Internet would normally invoke the Mark of the Web (MotW), warning about an untrusted file. But stuff a .theme inside a .themepack cab file, and no warning is shown.\nA .theme file can call a .msstyles file. If that .msstyle is set to version 999, some legacy handling code gets called, and the file name gets changed to end in _vrf.dll. The file is opened, the signature is checked, and the file is closed. If the signature verifies, the file is re-opened, and a function is called from within the DLL.\nAnd that is the Time Of Check, Time Of Use bug. There is an interruptable slice of time between closing the verified file, and reopening it. Normally a TOCTOU bug is a race condition, but the clever bit here is to use a remote SMB share as the .msstyles location. If thats an attacker controlled location, its trivial to swap out the verified DLL after the signature checks out. And thats it, a user trying to apply a theme runs arbitrary code with no warnings. For his findings, [Gabe] scored a $5000 bounty from Microsoft, and the version 999 legacy code has been removed, ending the exploit chain.\nBits and Bytes\nHPE Aruba 9000 series devices have a pair of high severity issues. The first allows for code execution early in the boot process, and the second allows for booting unsigned kernel images. Thats not really a problem for securely installed systems, but it does mean that an Aruba gateway could be tampered with in such a way that even a factory reset doesnt properly clear it back to default. Fixes are available.\nCisco has a CVSS 10.0 vulnerability in the Single Sign-On built in to BroadWorks. This can potentially affect quite a few Cisco applications that are part of the BroadWorks cloud calling platform. Cisco has issued updates to fix the problems.\nAnd finally, last week we talked about some unfixed issues in Notepad++. Were thrilled to see that a new release has been issued with fixes landing, likely partially spurred on by the coverage here and on other news sites."}