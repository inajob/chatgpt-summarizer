{"pubDate": "2025-12-19T15:00:01", "original_title": "This Week in Security: PostHog, Project Zero Refresh, and Thanks For All the Fish", "link": "https://hackaday.com/2025/12/19/this-week-in-security-posthog-project-zero-refresh-and-thanks-for-all-the-fish/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2016/01/darkarts.jpg", "original_content": "Theres something immensely satisfying about taking a series of low impact CVEs, and stringing them together into a full exploit. Thats the story we have from [Mehmet Ince] of Prodraft, who found a handful of issues in the default PostHog install instructions, and managed to turn it into a full RCE, though only accessible as a user with some configuration permissions.\nAs one might expect, it all starts with a Server Side Request Forgery (SSRF). Thats a flaw where sending traffic to a server can manipulate something on the server side to send a request somewhere else. The trick here is that a webhook worker can be primed to point at localhost by sending a request directly to a system API.\nOne of the systems that powers a PostHog install is the Clickhouse database server. This project had a problem in how it sanitized SQL requests, namely attempting to escape a single quote via a backslash symbol. In many SQL servers, a backslash would properly escape a single quote, but Clickhouse and other Postgresql servers dont support that, and treat a backslash as a regular character. And with this, a read-only SQL API is vulnerable to SQL injection.\nThese vulnerabilities together just allow for injecting an SQL string to create and run a shell command from within the database, giving an RCE and remote shell. The vulnerabilities were reported through ZDI, and things were fixed earlier this year.\nFreePBX\nSpeaking of SQL injections, FreePBX recently fixed a handful of SQL injections and an authentication bypass, and researchers at horizon3.ai have the scoop. None of these particular issues are vulnerable without either questionable configuration changes, or access to a valid PHP session ID token. The weakness here seems to be a very similar single quote injection.\nAnother fun SQL injection in FreePBX requires the authorization type swapped to webserver. But with that setting in place, an injected authentication header with only a valid user name is enough to pull off an SQL injection. The attack chosen for demonstration was to add a new user to the users table. This same authentication header spoof can be used to upload arbitrary files to the system, leading to an easy webshell.\nGoogle Project Zeros Refresh\nWeve often covered Googles Project Zero on this column, as their work is usually quite impressive. As their blog now points out, the homepage design left something to be desired. Thats changed now, with a sleek and modern new look! And no, thats not actually newsworthy here; stop typing those angry comments. The real news is the trio of new posts that came with the refresh.\nThe most recent is coverage of a VirtualBox VM excape via the NAT network driver. Its covering a 2017 vulnerability, so not precisely still relevant, but still worth a look. The key here is a bit of code that changes the length of the data structure based on the length of the IP header. Memory manipulation from an untrusted value. The key to exploitation is to manipulate memory to control some of the memory where packets are stored. Then use IP fragmentation packets to interleave that malicious data together and trigger the memory management flaw.\nThe second post is on Windows exploitation through race conditions and path lookups. This one isnt an exploit, but an examination of techniques that you could use to slow the Windows kernel down, when doing a path lookup, to exploit a race condition. The winner seems to be a combination of nested directories, with shadow directories and symbolic links. This combination can cost the kernel a whopping three minutes just to parse a path. Probably enough time.\nThe third entry is on an image-based malware campaign against Samsung Android phones. Malicious DNG files get processed by the Quram image processing library on Samsung devices. DNG images are a non-proprietary replacement for .raw image files, and the DNG format even includes features like embedding lens correction code right in the file format. This correction code is in the form of opcodes, that are handled very much like a script or small program on the host device. The Quram library didnt handle those programs safely, allowing them to write outside of the allocated memory for the image.\nBits and Bytes\nThe E-note domain and servers have been seized by law enforcement. Its believed that $70 million worth of ransomware and cryptocurrency theft has passed through this exchange service, as part of a money laundering operation. A Russian national has been named as the man behind the service, and an indictment has been made, but it seems that no actual arrests have been made.\nDropbear 2025.89 has been released, fixing a vulnerability where a user with SSH access could connect to any unix socket as root. This mishandling of socket permissions can lead to escalation of privilege in a multitude of ways.\nReact2shell was exploited in the wild almost as soon as it was announced. We covered the vulnerability as it was happening a couple weeks ago, and now its clear that ransomware campaigns were launched right away to take advantage of the exploit. Its also reported that it was used in Advanced Persistent Threat (APT) campaigns right away as well. Real Proof of Concept code is also now available.\nThanks for All the Fish!\nAnd lastly, on a personal note: Thank you to all the readers of this column over the last six years, and to the Hackaday editors for making it happen. Ive found myself in the position of having four active careers at once, and with the birth of my son in November, I have four children as well. Something has to give, and its not going to be any of the kids, so its time for me to move on from a couple of those careers. This Week in Security has been a blast, ever since the first installment back in May of 2019. With any luck, another writer will pick up the mantle early next year. (Editors note: Were working on it, but well miss you!)\nAnd if youre a fan of FLOSS Weekly, the other thing I do around here, dont worry, as its not going anywhere. Hope to see you all there!", "title": "- PostHog\u306eSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u304b\u3089\u5f97\u305f\u30ea\u30e2\u30fc\u30c8\u30b3\u30fc\u30c9\u5b9f\u884c\u306e\u6280\u8853", "body": "PostHog\u3084FreePBX\u3067\u306e\u8106\u5f31\u6027\u3092\u5229\u7528\u3057\u305fRCE\u3084SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u304c\u89e3\u8aac\u3055\u308c\u305f\u8a18\u4e8b\u3002", "titles": ["- PostHog\u306eSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u304b\u3089\u5f97\u305f\u30ea\u30e2\u30fc\u30c8\u30b3\u30fc\u30c9\u5b9f\u884c\u306e\u6280\u8853", "- FreePBX\u3067\u306e\u8a8d\u8a3c\u30d0\u30a4\u30d1\u30b9\u3068SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u306e\u8106\u5f31\u6027", "- Google Project Zero\u306e\u65b0\u3057\u3044\u30c7\u30b6\u30a4\u30f3\u3068\u6700\u65b0\u306e\u8a18\u4e8b\u306b\u3064\u3044\u3066", "- \u30b5\u30e0\u30b9\u30f3\u306eAndroid\u30c7\u30d0\u30a4\u30b9\u306b\u5bfe\u3059\u308b\u753b\u50cf\u30d9\u30fc\u30b9\u306e\u30de\u30eb\u30a6\u30a7\u30a2\u30ad\u30e3\u30f3\u30da\u30fc\u30f3", "- E-note\u3068Dropbear\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8106\u5f31\u6027\u306b\u3064\u3044\u3066\u306e\u6700\u65b0\u60c5\u5831"]}