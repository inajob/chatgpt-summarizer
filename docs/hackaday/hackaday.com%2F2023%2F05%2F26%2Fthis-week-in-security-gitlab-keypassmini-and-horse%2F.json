{"pubDate": "2023-05-26T14:00:50", "original_title": "This Week in Security: Gitlab, KeyPassMini, and Horse", "link": "https://hackaday.com/2023/05/26/this-week-in-security-gitlab-keypassmini-and-horse/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2016/01/darkarts.jpg", "original_content": "Theres a really nasty CVSS 10.0 severity vulnerability in Gitlab 16.0.0. The good news is that this is the only vulnerable version, and the fix came a mere two days after the vulnerable release. If you happened to be very quick to go to 16.0.0, then be very quick to get the fix, because CVE-2023-2825 looks like a bad one.\nAn unauthenticated malicious user can use a path traversal vulnerability to read arbitrary files on the server when an attachment exists in a public project nested within at least five groups.\nThats a very specific set of requirements for vulnerability, so it seems like hardly any installs would be vulnerable. The rest of the story is that regular users can create groups, and many installs allow for open user registration. So if youre running Gitlab 16.0.0, update now!\nKeyPassMini\nA Redditor got a surprising notice that someone attempted to access a bank account, but failed two-factor authentication. That seemed odd, and led the Redditor down the rabbithole of auditing applications. And one iOS app in particular stood out as maybe problematic  KeyPassMini.\nThe app was a mobile client for KeyPass, the password manager. The problem was some analytics. It looks like KeyPassMini was bundling up some system information and uploading it to a server controlled by the creator. Analytics are often unpopular, but this app was including the system clipboard contents in the uploaded data. Yikes! And it gets worse: The app does password fills by using that same clipboard, so some of the protected passwords may have been scooped up into that analytics data. And sent unencrypted. Oof.\n\nThis is crazy. An iOS KeePass app was sending the clipboard contents *unencrypted via UDP* to a server. The developer fixed it by still sending it via UDP, but this time with fixed key and IV. \nThe app is simply a credential stealer and probably in violation of some laws. pic.twitter.com/yjzok2jkB1\n stacksmashing (@ghidraninja) May 21, 2023\n\nNow, the app author has pulled the plug on the app altogether, and responded on the old Github project page. Its a bit odd, but its perfectly believable that there were no ill intentions here. Regardless, code to send the clipboard is a big problem, and definitely undoes a lot of trust in a project.\nAnd KeyPass itself has a problem, though much less worrying. KeyPass attempts to keep sensitive data out of its own memory when possible. This approach aims to protect even in the event of a compromised machine. [vdohney] on Sourceforge discovered that there is a channel to recover the master password, by being just a bit clever. When a user types in the master password, by default, KeyPass will show the last letter typed, and replace the previous letters with bullets. But each iteration of that string ends up in program memory, so a privileged attacker can get a memory dump, look for the bullet characters, and find a set of leftover strings like \u2022a, \u2022\u2022s, \u2022\u2022\u2022s, \u2022\u2022\u2022\u2022w, \u2022\u2022\u2022\u2022\u2022o, \u2022\u2022\u2022\u2022\u2022\u2022r, \u2022\u2022\u2022\u2022\u2022\u2022\u2022d. Its an easy password grab. Now remember, this essentially implies an attacker has memory access on your system, so its not a gaping weakness in KeyPass.\nAs you can see from the POC on GitHub, the problem is that a .NET text box keeps the strings in memory, so it probably hits both Windows and Linux users under Mono. The proposed solution that the KeyPass team is taking is to poison the well with enough random characters that retrieving the correct password is a lot harder. Its still getting fixed in the next release.\nHorse Shell for MIPS Routers\nCheckpoint Research brings us news of the Horse Shell, a bit of malware specifically for MIPS architecture routers running Linux. Its been found in TP-Link firmware images so far, but as so many of those routers are essentially based on the same Linux SDK, the malware appears to be applicable to many models. The exact firmware images being examined were found in a collection of tools used by Camaro Dragon, a rather catchy name for a Chinese APT group.\nThe firmware images have some of the normal bits you would expect, like data collection, remote shell, and remote proxy support. They have some really sneaky tricks, too, like storing part of the data on the partition reserved for WiFi calibration data. One has to wonder if hijacking that partition negatively affects the routers wireless performance. In the firmware images examined, the quickest tell is to go to the firmware upgrade page. If its blank, without a form to upload new firmware, you may have the malicious image.\nWordPress\nWordPress 6.2.1 has a security fix, that is then improved upon in 6.2.2, where block themes could parse user-generated shortcodes. A shortcode is tags inside [brackets], that gets replaced by more complicated data. We use a code shortcode all the time here on Hackaday, to try to get source code to render nicely, angle brackets and all.\nIt turns out, the fix in 6.2.1 went a little overboard, breaking quite a few sites by disabling shortcodes in block themes altogether. The situation in 6.2.2 is a bit better, with most of the problems being dealt with. Sometimes its hard to tell the bugs and the features apart.\nAnd a WordPress plugin, Beautiful Cookie Consent Banner, is under active attack for a Cross-Site Scripting vulnerability. The attack is odd, as WordPress.org shows just 40,000 active installs, and almost 1.5 million sites have been sent the malicious payload to try to exploit the plugin. And the kicker? It looks like the payload on this attack is a dud, and fails to actually infect a vulnerable site. It can still goober a vulnerable site, so make sure to check your plugins.\nBits and Bytes\nSpeaking of plugins, be careful what VScode plugins you use. Theyre not all friendly. Microsoft has been working to keep malicious plugins off the official marketplace, but that arms race never seems to have an end. And as such, there were a couple known malicious plugins with nearly 50,000 installs.\nFor some in-depth fun, check out this PDF paper on Android Fingerprint Reader attacks. It seems simple, right? Take a screenshot of a finger, compare it to a known data set, and lock the phone if the test fails too many times. It is, of course, not quite that simple. Researchers formulated two loopholes, Cancel-After-Match-Fail and Match-After-Lock, both of which abuse user-friendly features to manage way more attempts at a fingerprint read. Read the paper for the juicy details.\nAnd finally, Troy Hunt had some fun at the expense of a scammer. Troys wife was selling a fridge on Gumtree, and they decided to play along with a suspicious buyer. Turns out, its the old agent fee scam. Ill give you the money you asked for, plus $800 to cover the fee. Can you forward that extra money on? But of course, the Paypal confirmation message was faked, and there was no money paid. Troy managed to get an impressive bit of information, including that the scam is actually being run out of, you guessed it, Nigeria. Shipping would be a pain. \n\nSo @Charlotte_Hunt_ is selling a fridge on Gumtree and immediately starts getting messages like this. The first one gets a bit of \u201cno, we can discuss here\u201d and they disappear. This one\u2026 gets a burner address to see how weird shit gets. What\u2019s the angle? There\u2019s always an angle\u2026 pic.twitter.com/MRWep1MukS\n Troy Hunt (@troyhunt) May 22, 2023\n"}