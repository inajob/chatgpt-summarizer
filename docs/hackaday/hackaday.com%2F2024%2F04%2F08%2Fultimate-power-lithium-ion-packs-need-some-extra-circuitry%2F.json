{"pubDate": "2024-04-08T17:00:02", "original_title": "Ultimate Power: Lithium-Ion Packs Need Some Extra Circuitry", "link": "https://hackaday.com/2024/04/08/ultimate-power-lithium-ion-packs-need-some-extra-circuitry/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2022/09/Lithium.jpg", "original_content": "A LiIon pack might just be exactly what you need for powering a device of yours. Whether its a laptop, or a robot, or a custom e-scooter, a CPAP machine, theres likely a LiIon cell configuration that would work perfectly for your needs. Last time, we talked quite a bit about the parameters you should know about when working with existing LiIon packs or building a new one  configurations, voltage notations, capacity and internal resistance, and things to watch out for if youre just itching to put some cells together.\nNow, you might be at the edge your seat, wondering what kind of configuration do you need? What target voltage would be best for your task? Whats the physical arrangement of the pack that you can afford? What are the safety considerations? And, given those, what kind of electronics do you need?\nPicking The Pack Configuration\nPack configurations are well described by XsYp:X serial stages, each stage having Y cells in parallel. Its important that every stage is the same as all the others in as many parameters as possible  unbalanced stages will bring you trouble.\nTo get the packs nominal voltage, you multiply X (number of stages) by 3.7 V, because this is where your pack will spend most of its time. For example, a 3s pack will have 11.1 V nominal voltage. Check your cells datasheet  it tends to have all sorts of nice graphs, so you can calculate the nominal voltage more exactly for the kind of current youd expect to draw. For instance, the specific cells I use in a device of mine, will spend most of their time at 3.5 V, so I need to adjust my voltage expectations to 10.5 V accordingly if Im to stack a few of them together.\nNow, where do you want to fit your pack? This will determine the voltage. If you want to quickly power a device that expects 12 V, the 10.5 V to 11.1 V of a 3s config should work wonders. If your device detects undervoltage at 10.5V, however, you might want to consider adding one more stage.\nHow much current do you want to draw? For the cells you are using, open their spec sheet yet again, take the max current draw per cell, derate it by like 50%, and see how many cells you need to add to match your current draw. Then, add parallel cells as needed to get the capacity you desire and fit the physical footprint youre aiming for.\nThe last word for section this is on safety. When working with packs that exceed 20V , you are at a higher risk of injury than with the usual low-voltage electronics. DC doesnt shock you the way AC does, it makes your muscles contract in a way that risks you holding onto whatever is shocking you, and, it also can fry your muscles from the inside. If youre working with ebike packs, you should seriously heed the advice of having one hand in your pocket as much as humanly possible.\nNot only that, but working with LiIon packs is physically dangerous even if you dont get shocked. At a certain pack voltage and capacity, a short-circuit can blind you, and it will easily melt your metal tools  use plastic as much as possible. If it can drive your ebike motor, it contains enough energy to do a lot of damage.\nThankfully, in the end, safety is manageable. Plus, theres electronics that help you take care of it.\nElectronics And Balancing\nIn terms of circuitry, you need three things for a LiIon pack  charging, protection, and balancing. So, lets start with balancing, because balancing circuits give you some much-needed insights into LiIon pack charging requirements.\nBalancing is seriously required for LiIon packs that have more than one cell in series. A LiIon charger chip by definition doesnt monitor individual stages in the series. Over time, the stages in any pack will develop mismatches in internal resistance and capacity, if theyre not noticeably present by the moment the pack is built.\u00a0 During charging, this means that some of the stages might get fully charged while other stages havent finished charging yet  and a LiIon charger thats only connected to the single series ground and output cant detect that, so it will continue pumping current into the pack, which might lead to overcharging.\nBalancers are circuits you build into the LiIon pack directly, in parallel with every stage, that contain a hefty resistor and can shunt the entire charging current away from a cell stage when the voltage on the stage exceeds the maximum voltage threshold. As the pack is charging, the balancers will turn on one by one, protecting the stages with lowest capacity from overcharge. Balancers are simple: you can build one with a resistor, TL431, and a random FET from a desktop motherboard. Of course, there is a balancer available on the market for nearly every battery configuration too.\nYou have to add a balancer if you want your pack to be safe, doubly so with high stage count packs where even miniscule differences will soon be exacerbated. And triply so if youre making your pack out of salvaged batteries, which may have mismatches that series charging would exacerbate.\nIf youre looking for a protection circuit that does balancing for you, look out for rows of SMD resistors on the board. Balancers are not a substitute for a badly built pack  they cant dissipate all that much current; ultimately, they are safeguards that help keep a good pack from going bad, and you need them just as much as you need both the charging and protection circuits.\nCharging And Protection\nOnce you move to a multi-stage pack, the classic TP4056 single-stage chargers will not work anymore, as much as I love them. Instead, get a charger chip that can handle series configurations  you can find them reasonably easily. For low-count-series and high-count-series packs, there are plenty of charging circuits on Aliexpress. For low-count-series packs, these circuits take the form of small modules, TP4056-like, just explicitly being marked 2s or 8.4 V.\u00a0\nBest is if everything is under your control. You must have control over chargers configured termination voltage, or at least know what voltage its set to  too high and you overcharge, which is pretty bad; too low and you undercharge, which is actually beneficial for pack health but will result in you losing out on capacity. You will likely want control over charging current, too  just like with voltage, it can be too small, but it cant be too large.\nAs with the single-cell setups, there are also multi-series protection circuits that safeguard you from overcurrent and overdischarge. These arent meant as a substitute for proper handling, but they can protect you from accidents like short-circuits on the output or a charger going haywire; not that there cant be a spark, but the sparks consequences will be greatly diminished.\nIts even more convenient when the balancing circuit and overdischarge are included in one PCB. These battery management system boards (BMS) are plentiful on the market and take care of everything under one roof. Look for large SMD resistors as a good indicator that the circuit has balancing as well as overcurrent protection. These boards often lack programmable overcurrent thresholds, though, so be ready to find part numbers for extra FETs and solder them onto conveniently unpopulated footprints if you want to up the limit.\nThese are the basics you need to work with a multi-stage pack. Is anything unclear? Ask in the comments below  this is the kind of topic where misunderstandings are worth getting corrected early.", "title": "LiIon\u30d1\u30c3\u30af\u306e\u9078\u3073\u65b9\u3068\u69cb\u6210", "body": "LiIon\u30d1\u30c3\u30af\u306f\u6a5f\u5668\u3092\u52d5\u304b\u3059\u306e\u306b\u5fc5\u8981\u306a\u3082\u306e\u3002\u30e9\u30c3\u30d7\u30c8\u30c3\u30d7\u3001\u30ed\u30dc\u30c3\u30c8\u3001\u96fb\u52d5\u30b9\u30af\u30fc\u30bf\u30fc\u3001CPAP\u6a5f\u5668\u306a\u3069\u306b\u6700\u9069\u3002\u9069\u5207\u306a\u30bb\u30eb\u306e\u69cb\u6210\u3001\u96fb\u5727\u8a18\u53f7\u3001\u5bb9\u91cf\u3001\u5185\u90e8\u62b5\u6297\u306b\u3064\u3044\u3066\u6ce8\u610f\u3002\u5b89\u5168\u4fdd\u8b77\u3001\u5145\u96fb\u3001\u4fdd\u8b77\u3001\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u5fc5\u9808\u3002\u8abf\u6574\u304c\u5fc5\u8981\u3002", "titles": ["LiIon\u30d1\u30c3\u30af\u306e\u9078\u3073\u65b9\u3068\u69cb\u6210", "LiIon\u30d1\u30c3\u30af\u306e\u5b89\u5168\u6027\u3068\u6ce8\u610f\u70b9", "LiIon\u30d1\u30c3\u30af\u306e\u96fb\u5b50\u56de\u8def\u3068\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0", "LiIon\u30d1\u30c3\u30af\u306e\u5145\u96fb\u3068\u4fdd\u8b77\u65b9\u6cd5", "\u591a\u6bb5\u968eLiIon\u30d1\u30c3\u30af\u306e\u57fa\u672c\u4e8b\u9805"]}