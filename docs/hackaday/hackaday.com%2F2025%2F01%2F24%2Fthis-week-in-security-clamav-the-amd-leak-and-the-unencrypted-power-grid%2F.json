{"pubDate": "2025-01-24T15:00:05", "original_title": "This Week in Security: ClamAV, The AMD Leak, and The Unencrypted Power Grid", "link": "https://hackaday.com/2025/01/24/this-week-in-security-clamav-the-amd-leak-and-the-unencrypted-power-grid/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2016/01/darkarts.jpg", "original_content": "Ciscos ClamAV has a heap-based buffer overflow in its OLE2 file scanning. Thats a big deal, because ClamAV is used to scan file attachments on incoming emails. All it takes to trigger the vulnerability is to send a malicious file through an email system that uses ClamAV.\nThe exact vulnerability is a string termination check that can fail to trigger, leading to a buffer over-read. Thats a lot better than a buffer overflow while writing to memory. That detail is why this vulnerability is strictly a Denial of Service problem. The memory read results in process termination, presumably a segfault for reading protected memory. There are Proof of Concepts (PoCs) available, but so far no reports of the vulnerability being used in the wild.\n\nAMD Vulnerability Leaks\nAMD has identified a security problem in how some of its processors verify the signature of microcode updates. Thats basically all we know about the issue, because the security embargo still isnt up. Instead of an official announcement, we know about this issue via an Asus beta BIOS release that included a bit too much information.\nI Read the Docs\nTheres nothing quite as fun as winning a Capture The Flag (CTF) challenge the wrong way. The setup for this challenge was a simple banking application, with the challenge being to steal some money from the banks website. The intended solution was to exploit the way large floating point numbers round small values. Deposit 1e10 dollars into the bank, and a withdraw of $1000 is literally just a rounding error.\nThe unintended solution was to deposit NaN dollars. In JavaScript-speak thats the special Not a Number value thats used for oddball situations like dividing by a float thats rounded down to zero. NaN has some other strange behaviors, like always resulting in false comparisons. NaN  0? False. NaN  0? False. NaN == NaN? Yep, also false. And when the fake bank web app checks if a requested withdraw amount is greater than the amount in the account? Since the account is set to NaN, its also false. Totally defeats the internal bank logic. How did the student find this unintended solution? I read the docs. Legendary.\nAnother Prompt Injection Tool\n[Utku Sen] has a story and a revamped tool, and it leads to an interesting question about LLMs. The story starts with a novel LLM prompt, that gives more natural sounding responses from AI tools. LLMs have a unique problem, that there is no inherent difference between pre-loaded system prompts, and user-generated prompts. This leads to an attack, where a creative user prompt can reveal the system prompt. And in a case like [Utku]s, the system prompt is the special sauce that makes the service work. He knew this, and attempted to protect against such attacks. Within an hour of releasing the tool to the public, [Utku] got a direct message on X with the system prompts.\nTheres a really interesting detail, that the prompt injection attack only worked 1 out of 11 times. This sent me down an LLM rabbit hole, asking whether LLMs are deterministic, and if not, why not. The simple answer is the temperature control knob on LLMs add some random noise to the output text. There seems to be randomness even when the LLM temperature is turned to zero, caused either by floating point errors, or even a byproduct of doing batched inference. Regardless, prompt injection attacks may only work after several tries.\nAnd that brings us to promptmap tool. It is intended to evaluate a system prompt, and launch multiple attempts to poison or otherwise inject malicious user prompts into the system. And of course, it is now capable of using the approach that successfully revealed [Utku]s system prompt.\nCloudflares Unintentional GPS\nTheres a really interesting unintended side effect of using Cloudflares CDN network: Users load data from the nearest datacenter. Unique data can be served to a target user, and then the cache can be checked to leak coarse location information. This is novel research, but ultimately not actually all that important from a security perspective. The primary reason is that the same sort of attack has always existed and can be used to extract a much more valuable piece of user identifying data: The users IP address.\nThe Unauthenticated, Unencrypted radios that control The German Power Grid\n[Fabian Br\u00e4unlein] and [Luca Melette] were just looking for radio-controlled light switches, to pull off a modern take on Project Blinkenlights. What they found was the Radio Ripple Control protocol, an unauthenticated, unencrypted radio control protocol. That just happens to control about 40 Gigawatts of power generation across Germany, not to mention street lamps and other bits of hardware.\nThe worst-case scenario for an attacker is to turn on all of the devices that use grid power, while turning off all of the connected devices that generate power. Too much of an imbalance might even be capable of resulting in the dreaded grid-down scenario, where all the connected power generation facilities lose sync with each other, and everything has to be disconnected. Recovery from such a state would be slow and tedious. And thankfully not actually very likely. But even if this worst-case scenario isnt very realistic, its still a severe vulnerability in how the German grid is managed. And fixes dont seem to be coming any time soon.\nBits and Bytes\nThe Brave browser had a bit of a dishonest downloads issue, where the warning text about a download would show the URL from the referrer header. The danger is that a download may be considered trustworthy, even when its actually being served from an arbitrary URL.\nIf JavaScript in general or next.js in particular is in your security strike zone, youll want to check out the write-up from [Rachid.A] about cache poisoning in this particular framework, and the nice cache of security bounties it netted.\nZoom has a weird security disclosure for one of their Linux applications, and it contains a description Ive never seen before: The bug may allow an authorized user to conduct an escalation of privilege via network access. Given the CVSS score of 8.8 with an attack vector of network, this should probably be called a Remote Code Execution vulnerability.\nSubaru had a problem with STARLINK. No, not the satellite Internet provider, the other STARLINK. Thats Subarus vehicle technology platform that includes remote start and vehicle tracking features. That platform had a pair of flaws, the first allowing an attacker to reset any admins password. The second is that the Two Factor Authentication protection can be bypassed simply by hiding the pop-up element in the HTML DOM. Whoops! Subaru had the issues fixed in under 24 hours, which is impressive.\nAnd finally, Silent Signal has the intriguing story of IBMs i platform, and and a compatibility issue with Windows 11. That compatibility issue was Microsoft cracking down on apps sniffing Windows passwords. And yes, IBM i was grabbing Windows passwords and storing them in the Windows registry. What a trip.", "title": "ClamAV\u306e\u8106\u5f31\u6027\uff1a\u30e1\u30fc\u30eb\u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u306e\u653b\u6483\u30ea\u30b9\u30af", "body": "Ciscos ClamAV\u306b\u30d0\u30c3\u30d5\u30a1\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u8106\u5f31\u6027\u3001AMD\u30d7\u30ed\u30bb\u30c3\u30b5\u306e\u66f4\u65b0\u7f72\u540d\u554f\u984c\u767a\u899a\u3002", "titles": ["ClamAV\u306e\u8106\u5f31\u6027\uff1a\u30e1\u30fc\u30eb\u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u306e\u653b\u6483\u30ea\u30b9\u30af", "AMD\u30d7\u30ed\u30bb\u30c3\u30b5\u306e\u7f72\u540d\u78ba\u8a8d\u554f\u984c\uff1a\u8a73\u7d30\u306f\u672a\u767a\u8868", "\u6355\u307e\u3089\u306a\u3044\uff01\u4e0d\u6b63\u306a\u9280\u884c\u30a2\u30d7\u30ea\u306b\u304a\u3051\u308bCTF\u6311\u6226", "Cloudflare\u306eCDN\u304c\u5f15\u304d\u8d77\u3053\u3059\u4e88\u671f\u305b\u306cGPS\u60c5\u5831\u6f0f\u308c", "\u30c9\u30a4\u30c4\u306e\u96fb\u529b\u7db2\u7ba1\u7406\u306b\u304a\u3051\u308b\u7121\u8a8d\u8a3c\u7121\u6697\u53f7\u306e\u30e9\u30b8\u30aa\u5236\u5fa1\u30d7\u30ed\u30c8\u30b3\u30eb\u306e\u8106\u5f31\u6027"]}