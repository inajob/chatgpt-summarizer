{"pubDate": "2025-01-10T21:00:25", "original_title": "Bit-Banging the USB-PD Protocol", "link": "https://hackaday.com/2025/01/10/bit-banging-the-usb-pd-protocol/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2025/01/esp32-usbpd-main.jpg", "original_content": "For one-off projects, adding a few integrated circuits to a PCB is not too big of a deal. The price of transistors is extremely low thanks to Moore and his laws, so were fairly free to throw chips around like peanuts. But for extremely space-constrained projects, huge production runs, or for engineering challenges, every bit of PCB real estate counts. [g3gg0] falls into the latter group, and this project aims to remove the dedicated USB-PD module from a lighting project and instead bit-bang the protocol with the ESP32 already on the board.\nThe modern USB power delivery (PD) protocol isnt quite as simple as older USB ports that simply present a 5V source to whatever plugs itself into the port. But with the added complexity we get a lot more capability including different voltages and greater power handling capabilities. The first step with the PD protocol is to communicate with a power source, which requires a 1.2V 600kHz signal. Just generating the signal is challenging enough, but the data encoding for USB requires level changes to encode bits rather than voltage levels directly. With that handled, the program can then move on to encoding packets and sending them out over the bus.\nAfter everything is said and done, [g3gg0] has a piece of software that lets the ESP32 request voltages from a power supply, sniff and log PD communication, and inject commands with vendor defined messages (VDM), all without needing to use something like a CH224K chip which would normally offload the USB-PD tasks. For anyone looking to save PCB space for whatever reason, this could be a valuable starting point. To see some more capabilities of the protocol, check out this USB-PD power supply that can deliver 2 kW.", "title": "ESP32\u3092\u4f7f\u7528\u3057\u305fUSB-PD\u30d7\u30ed\u30c8\u30b3\u30eb\u306e\u81ea\u4f5c\u65b9\u6cd5", "body": "USB-PD\u30e2\u30b8\u30e5\u30fc\u30eb\u3092ESP32\u306b\u7f6e\u304d\u63db\u3048\u3001PCB\u30b9\u30da\u30fc\u30b9\u3092\u7bc0\u7d04\u3057\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3002", "titles": ["ESP32\u3092\u4f7f\u7528\u3057\u305fUSB-PD\u30d7\u30ed\u30c8\u30b3\u30eb\u306e\u81ea\u4f5c\u65b9\u6cd5", "\u9650\u3089\u308c\u305fPCB\u30b9\u30da\u30fc\u30b9\u3092\u6709\u52b9\u6d3b\u7528\u3059\u308b\u305f\u3081\u306eUSB-PD\u6539\u9020", "USB-PD\u306e\u57fa\u672c\u3068ESP32\u306b\u3088\u308b\u5b9f\u88c5\u30c1\u30e3\u30ec\u30f3\u30b8", "\u96fb\u529b\u4f9b\u7d66\u306e\u65b0\u3057\u3044\u53ef\u80fd\u6027\uff1aUSB-PD\u3092\u30c7\u30b8\u30bf\u30eb\u5316\u3059\u308b", "PCB\u30b9\u30da\u30fc\u30b9\u7bc0\u7d04\u306e\u305f\u3081\u306eUSB-PD\u901a\u4fe1\u6280\u8853"]}