{"pubDate": "2024-03-08T12:00:18", "original_title": "Extracting SecOC Keys From a 2021 Toyota RAV4 Prime", "link": "https://hackaday.com/2024/03/08/extracting-secoc-keys-from-a-2021-toyota-rav4-prime/", "source": "https://hackaday.com/blog/feed/", "thumbnail": "https://hackaday.com/wp-content/uploads/2024/03/secoc_feat.png", "original_content": "With the recently introduced SecOC (Secure Onboard Communication) standard, car manufacturers seek to make the CAN bus networks that form the backbone of modern day cars more secure. This standard adds a MAC (message authentication code) to the CAN messages, which can be used to validate that these messages come from a genuine part of the car, and not from a car thief or some third-party peripheral.\nTo check that it isnt possible to circumvent SecOC,\u00a0[Willem Melching] and [Greg Hogan] got their hands on the power steering (EPS) unit of a Toyota RAV4 Prime, as one of the first cars to implement this new security standard.\nThe 2021 Toyota RAV4 Primes power steering unit on the examination bench. (Credit: Willem Melching)\nAs noted by [Willem], the ultimate goal is to be able to run the open source driver assistance system openpilot on these SecOC-enabled cars, which would require either breaking SecOC, or following the official method of rekeying the SecOC gateway.\nAfter dumping the firmware of the EPS Renesas RH850/P1M-E MCU via a voltage fault injection, the AES-based encryption routines were identified, but no easy exploits found in the main application. This left the bootloader as the next target.\nUltimately they managed to reverse-engineer the bootloader to determine how the update procedure works, which enabled them to upload shellcode. This script then enabled them to extract the SecOC keys from RAM and send these over the CAN bus. With these keys the path is thus opened to allow any device to generate CAN messages with valid SecOC MACs, effectively breaking encryption. Naturally, there are many caveats with this discovery.\n\nAs noted in the blog post, the specific MCU targeted did the crypto routines in software rather than using a more secure hardware module, while also omitting to validate the payload sent to the bootloader. That said, it might be that this approach works even with much newer SecOC implementations. Some experimentation on a 2023 Corolla Cross demonstrated that its power steering unit could also be coaxed into allowing code execution via the bootloader, but further attempts at defeating SecOC on it havent been made yet.\n\nA GitHub repository containing the the software tools to extract keys and such has been made available.\nWhile SecOC promises to make the future of CAN hacking more difficult, theres still millions of vehicles on the road that are all too happy to let you poke around in their data networks  allowing you to do everything from pulling EV battery info to adding a backup camera so long as you have the proper tools.", "title": "\u81ea\u52d5\u8eca\u306eCAN\u30d0\u30b9\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u5b89\u5168\u306b\u3059\u308bSecOC\u6a19\u6e96\u3068\u306f\u4f55\u304b", "body": "\u6700\u8fd1\u5c0e\u5165\u3055\u308c\u305fSecOC\uff08Secure Onboard Communication\uff09\u6a19\u6e96\u3067\u306f\u3001\u81ea\u52d5\u8eca\u30e1\u30fc\u30ab\u30fc\u304c\u30e2\u30c0\u30f3\u306a\u81ea\u52d5\u8eca\u306e\u30d0\u30c3\u30af\u30dc\u30fc\u30f3\u3092\u5f62\u6210\u3059\u308bCAN\u30d0\u30b9\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u3088\u308a\u5b89\u5168\u306b\u3059\u308b\u3053\u3068\u3092\u76ee\u6307\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u3001\u81ea\u52d5\u8eca\u306e\u672c\u7269\u306e\u90e8\u5206\u304b\u3089\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3067\u3042\u308b\u3053\u3068\u304c\u691c\u8a3c\u3067\u304d\u307e\u3059\u3002\u3042\u308b\u7814\u7a76\u3067\u306f\u3001Toyota RAV4 Prime\u306e\u96fb\u52d5\u30d1\u30ef\u30fc\u30b9\u30c6\u30a2\u30ea\u30f3\u30b0\u30e6\u30cb\u30c3\u30c8\u3092\u8abf\u67fb\u3057\u3001\u3053\u308c\u306b\u3088\u308aSecOC\u306e\u9375\u3092\u53d6\u5f97\u3057\u3066\u6697\u53f7\u5316\u3092\u89e3\u8aad\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3068\u306a\u308a\u307e\u3057\u305f\u3002", "titles": ["\u81ea\u52d5\u8eca\u306eCAN\u30d0\u30b9\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u5b89\u5168\u306b\u3059\u308bSecOC\u6a19\u6e96\u3068\u306f\u4f55\u304b", "SecOC\u3092\u30d0\u30a4\u30d1\u30b9\u3059\u308b\u65b9\u6cd5\u3092\u691c\u8a3c\u3057\u305f\u96fb\u5b50\u5de5\u4f5c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8", "SecOC\u3092\u7834\u308b\u305f\u3081\u306e\u624b\u6cd5: \u30d1\u30ef\u30fc\u30b9\u30c6\u30a2\u30ea\u30f3\u30b0\u30e6\u30cb\u30c3\u30c8\u306e\u89e3\u6790", "\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u306e\u904b\u8ee2\u652f\u63f4\u30b7\u30b9\u30c6\u30e0openpilot\u3092SecOC\u8eca\u306b\u52d5\u4f5c\u3055\u305b\u308b\u305f\u3081\u306e\u8a66\u307f", "\u8eca\u4e21\u306eCAN\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u508d\u53d7\u3059\u308b\u305f\u3081\u306e\u96fb\u5b50\u5de5\u4f5c\u624b\u6cd5"]}